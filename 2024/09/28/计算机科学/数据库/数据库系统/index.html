



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/cyy.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="眨眼的小星玥" href="http://www.luckycyyyy.top/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="眨眼的小星玥" href="http://www.luckycyyyy.top/atom.xml" />
<link rel="alternate" type="application/json" title="眨眼的小星玥" href="http://www.luckycyyyy.top/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="数据库" />


<link rel="canonical" href="http://www.luckycyyyy.top/2024/09/28/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/">



  <title>
数据库系统 - 数据库 - 计算机科学 |
Aurijun = 眨眼的小星玥 = 世间风物论自由，喜一生我有，共四海丰收</title>
<meta name="generator" content="Hexo 7.2.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">数据库系统
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2024-09-28 09:41:45">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2024-09-28T09:41:45+08:00">2024-09-28</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>33k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>30 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Aurijun</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://dlink.host/wx4.sinaimg.cn/large/007CYURoly8hzn7lfw3c5j31hc0u04da.jpg"></li>
          <li class="item" data-background-image="https://s21.ax1x.com/2025/03/22/pE06NnO.jpg"></li>
          <li class="item" data-background-image="https://haowallpaper.com/link/common/file/previewFileImg/16598729988427136"></li>
          <li class="item" data-background-image="https://dlink.host/wx1.sinaimg.cn/large/007CYURoly8hzocea4qsfj31hc0u0gq0.jpg"></li>
          <li class="item" data-background-image="https://haowallpaper.com/link/common/file/previewFileImg/42bd51d51bb7622db7832be5d93c31f942bd51d51bb7622db7832be5d93c31f9"></li>
          <li class="item" data-background-image="https://s21.ax1x.com/2025/03/22/pE06UBD.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a>
<meta itemprop="position" content="1" /></span>
<i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="item" rel="index" title="分类于 数据库"><span itemprop="name">数据库</span></a>
<meta itemprop="position" content="2" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="http://www.luckycyyyy.top/2024/09/28/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/cyy.png">
    <meta itemprop="name" content="Aurijun">
    <meta itemprop="description" content="世间风物论自由，喜一生我有，共四海丰收, 小星玥，要努力学习呀！">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="眨眼的小星玥">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="绪论"><a class="markdownIt-Anchor" href="#绪论">#</a> 绪论</h1>
<h2 id="数据库系统概述"><a class="markdownIt-Anchor" href="#数据库系统概述">#</a> 数据库系统概述</h2>
<h3 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念">#</a> 基本概念</h3>
<p><strong>数据</strong></p>
<p><strong>数据库 (DB)</strong>：是长期储存在计算机内、有组织的、可共享的大量数据的集合，数据按一定的数据模型组织、描述和储存</p>
<ul>
<li>可为各种用户共享</li>
<li>冗余度较小</li>
<li>数据独立性较高</li>
<li>易扩展</li>
</ul>
<p><strong>数据库管理系统 (DBMS)</strong></p>
<ul>
<li>数据定义功能，数据定义语言：DDL</li>
<li>数据组织、存储和管理</li>
<li>数据操纵功能，数据操纵语言：DML</li>
<li>数据库的事务管理和运行管理</li>
<li>数据库的建立和维护功能</li>
<li>其他功能</li>
</ul>
<p><strong>数据库系统 (DBS)</strong>：由数据库（DB）、数据库管理系统（DBMS）、应用程序和数据库管理员（DBA）组成的存储、管理、处理和维护数据的系统。</p>
<h3 id="数据管理技术的产生和发展"><a class="markdownIt-Anchor" href="#数据管理技术的产生和发展">#</a> 数据管理技术的产生和发展</h3>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410311024522.jpg" alt=""></p>
<p>文件系统：即专门处理数据的应用，程序员要关注记录的结构和不同文件中记录之间的联系，使用文件系统提供的 <code>fopen</code>  等操作来进行编程</p>
<p>数据库系统：只用一条语句就能实现查询操作</p>
<h3 id="数据库系统特点"><a class="markdownIt-Anchor" href="#数据库系统特点">#</a> 数据库系统特点</h3>
<ol>
<li>
<p><strong>数据结构化</strong>：实现整体数据的结构化，是数据库系统与文件系统的本质区别。“整体” 指的是数据库中的数据不再针对某一个应用，而是面向整个组织</p>
</li>
<li>
<p><strong>数据的共享性高，冗余度低且易扩充</strong>：数据共享可以大大减少数据冗余，节约存储空间，且能避免数据之间的不相容性与不一致性；还容易添加新的应用，使得数据库系统弹性大，易于扩充。</p>
</li>
<li>
<p><strong>数据独立性高</strong>：利用<strong>二级映像</strong>功能实现，简化应用程序的编制，减少应用程序的维护和修改</p>
<ul>
<li>物理独立性：用户的应用程序与数据库中数据的物理存储是相互独立的</li>
<li>逻辑独立性：用户的应用程序与数据库的逻辑结构是相互独立的</li>
</ul>
</li>
<li>
<p>数据由数据库管理系统<strong>统一</strong>管理和控制</p>
<ul>
<li>数据的安全性保护：防止不合法使用造成的数据泄露和破坏</li>
<li>数据的完整性检查：保证数据的正确性、有效性和相容性</li>
<li>并发控制</li>
<li>数据库恢复</li>
</ul>
</li>
</ol>
<h2 id="数据模型"><a class="markdownIt-Anchor" href="#数据模型">#</a> 数据模型</h2>
<h3 id="组成要素"><a class="markdownIt-Anchor" href="#组成要素">#</a> 组成要素</h3>
<p>数据结构：描述数据库的组成对象，以及对象之间的联系。数据结构是对系统<strong>静态特性</strong>的描述</p>
<p>数据的操作：查询，增删改。数据操作是对系统<strong>动态特性</strong>的描述</p>
<p>数据的完整性约束：给定的数据模型中数据及其联系所具有的制约和依存规则</p>
<h3 id="概念模型"><a class="markdownIt-Anchor" href="#概念模型">#</a> 概念模型</h3>
<p>也称信息模型，按用户的观点对数据和信息建模</p>
<p><strong>基本概念</strong></p>
<p>实体：客观存在并可相互区别的事物</p>
<p>属性：实体所具有的某一特性成为属性</p>
<p>码：唯一标识实体的属性</p>
<p>联系：是一支箭的联系通常是指不同实体集之间的联系。有一对一、一对多、多对多的类型</p>
<p><strong>表示方式</strong></p>
<p>实体 - 联系方法，即 E-R 模型</p>
<h3 id="逻辑模型"><a class="markdownIt-Anchor" href="#逻辑模型">#</a> 逻辑模型</h3>
<p><strong>层次模型</strong></p>
<p><strong>网状模型</strong></p>
<p><strong>关系模型</strong></p>
<p>关系模型中数据的逻辑结构是一张二维表，它由行和列组成</p>
<p>关系：一个关系对应通常说的一张表。关系的每一个分量必须是一个不可分的数据项。</p>
<p>元组：表中的一行即为一个元组</p>
<p>属性：表中的一列即为一个属性，给每一个属性起一个名称即属性名</p>
<p>主码：也称码键。表中的某个属性组，它可以唯一确定一个元组</p>
<p>域：一组具有相同数据类型的值的集合</p>
<p>分量：元组中的一个属性值</p>
<p><strong>优点</strong></p>
<ul>
<li>建立在严格的数学概念的基础上（关系代数等）</li>
<li>概念单一：实体和各类联系都用关系来表示，对数据的检索结果也是关系，数据结构简单清晰、用户易懂易用</li>
<li>关系模型的存取路径对用户透明，具有更高的数据独立性，更好的安全保密性，简化了程序员的工作和数据库开发建立的工作</li>
</ul>
<p><strong>半结构化数据模型</strong></p>
<h3 id="物理模型"><a class="markdownIt-Anchor" href="#物理模型">#</a> 物理模型</h3>
<p>描述数据在系统内部的表示方式和存取方式，或在磁盘或磁带上的存储方式和存取方式</p>
<h2 id="数据库系统结构"><a class="markdownIt-Anchor" href="#数据库系统结构">#</a> 数据库系统结构</h2>
<h3 id="三级模式结构"><a class="markdownIt-Anchor" href="#三级模式结构">#</a> 三级模式结构</h3>
<p>数据库系统通常采用<strong>三级模式结构</strong>，是数据库系统内部的系统结构</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410311121223.png" alt=""></p>
<p><strong>模式</strong>：数据库中<strong>全体</strong>数据的逻辑结构和特征的描述</p>
<p><strong>外模式</strong>：数据库用户使用的<strong>局部</strong>数据的逻辑结构和特征的描述，是与<strong>某一应用有关</strong>的数据的逻辑表示</p>
<p><strong>内模式</strong>：是数据<strong>物理结构和存储方式</strong>的描述，是数据在数据库<strong>内部</strong>的表示方式</p>
<h3 id="二级映射功能与数据独立性"><a class="markdownIt-Anchor" href="#二级映射功能与数据独立性">#</a> 二级映射功能与数据独立性</h3>
<ul>
<li>外模式 / 模式映像</li>
<li>模式 / 内模式映像</li>
</ul>
<p>保证数据的<strong>逻辑独立性</strong>和<strong>物理独立性</strong></p>
<p>保证数据的<strong>逻辑独立性</strong>：当模式改变时，数据库管理员对外模式／模式映象作相应改变，使外模式保持不变，从而应用程序不必修改</p>
<p>保证数据的<strong>物理独立性</strong>：当数据库的存储结构改变了（例如选用了另一种存储结构），数据库管理员修改模式／内模式映象，模式保持不变</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410311125281.png" alt=""></p>
<h1 id="关系数据库"><a class="markdownIt-Anchor" href="#关系数据库">#</a> 关系数据库</h1>
<h2 id="关系数据结构及形式化定义"><a class="markdownIt-Anchor" href="#关系数据结构及形式化定义">#</a> 关系数据结构及形式化定义</h2>
<p><strong>域</strong>：是一组具有相同数据类型的值的集合。</p>
<p><strong>关系</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mn>1</mn><mo>×</mo><mi>D</mi><mn>2</mn><mo>×</mo><mo>…</mo><mo>×</mo><mi>D</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">D1×D2×…×Dn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">n</span></span></span></span> 的子集叫作在域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mn>1</mn><mtext>，</mtext><mi>D</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>D</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">D1，D2，…，Dn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">n</span></span></span></span> 上的关系，表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mtext>（</mtext><mi>D</mi><mn>1</mn><mtext>，</mtext><mi>D</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>D</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R（D1，D2，…，Dn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">（</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，（R：关系名，n：关系的目或度）</p>
<p><strong>关系的表示</strong>：关系是一个二维表，表的每行对应一个元组，表的每列对应一个域</p>
<p><strong>属性</strong>：关系中不同列可以对应相同的域，必须对每列起一个名字，称为属性，n 目关系必有 n 个属性</p>
<p><strong>码</strong></p>
<ul>
<li><strong>候选码</strong>：若关系中的某一属性组的值能<strong>唯一</strong>地标识一个元组，而其子集不能，则称该属性组为候选码（特例：候选码只包含一个属性）</li>
<li><strong>主属性</strong>：候选码的诸属性称为主属性，其他为非主属性</li>
<li><strong>主码</strong>：若一个关系有多个候选码，则选定其中一个为主码</li>
<li><strong>全码</strong>：关系模式的所有属性组是这个关系模式的候选码，称为全码</li>
</ul>
<p><strong>关系的类型</strong>：</p>
<ul>
<li>基本关系：又称基本表或基表，是实际存在的表，是实际存储数据的逻辑表表示</li>
<li>查询表：查询结果对应的表</li>
<li>视图表：是由基本表或其他视图表导出的表，是虚表</li>
</ul>
<p><strong>关系的性质</strong></p>
<ol>
<li>列是同质的。每一列中的分量必须来自同一个域，必须是同一类型数据。</li>
<li>不同的列可出自同一个域。不同的属性要给予不同的属性名</li>
<li>列的顺序无所谓，列的次序可以任意交换</li>
<li>任意两个元组的候选码不能相同</li>
<li>行的顺序无所谓，行的次序可以任意交换</li>
<li>属性分量必须取原子值。属性不能是表格，包含多个值的组合。关系的每一个分量必须是一个不可分的数据项。</li>
</ol>
<p><strong>关系模式</strong></p>
<p>关系模式</p>
<ul>
<li>对关系的描述</li>
<li>是静态的、稳定的</li>
</ul>
<p>关系</p>
<ul>
<li>
<p>关系模式在某一时刻的状态或内容</p>
</li>
<li>
<p>是动态的、随时间不断变化的</p>
</li>
</ul>
<p>关系模式和关系往往笼统称为关系</p>
<p><strong>关系数据库</strong></p>
<p>在一个给定的应用领域中，所有关系的集合构成一个关系数据库</p>
<p><strong>关系数据库的型与值</strong>：</p>
<p>关系数据库的型：关系数据库<strong>模式</strong>，是对关系数据库的<strong>描述</strong></p>
<p>关系数据库的值：关系模式在<strong>某一时刻对应</strong>的关系的集合，通常称为关系数据库</p>
<h2 id="关系操作"><a class="markdownIt-Anchor" href="#关系操作">#</a> 关系操作</h2>
<p>集合操作方式。操作的<strong>对象和结果都是集合</strong>，<strong>一次一集合</strong>的方式</p>
<h2 id="关系的完整性"><a class="markdownIt-Anchor" href="#关系的完整性">#</a> 关系的完整性</h2>
<h3 id="实体完整性"><a class="markdownIt-Anchor" href="#实体完整性">#</a> 实体完整性</h3>
<p>若属性<em> A</em> 是基本关系<em> R</em> 的主属性，则属性<em> A</em> 不能取空值</p>
<h3 id="参照完整性"><a class="markdownIt-Anchor" href="#参照完整性">#</a> 参照完整性</h3>
<p>若属性（或属性组）F 是基本关系 R 的外码，它与基本关系 S 的主码 Ks 相对应（基本关系 R 和 S 不一定是不同的关系），则对于 R 中每个元组在 F 上的值必须为：</p>
<ul>
<li>取空值（F 的每个属性值均为空值）</li>
<li>等于 S 中某个元组的主码值</li>
</ul>
<h3 id="用户定义的完整性"><a class="markdownIt-Anchor" href="#用户定义的完整性">#</a> 用户定义的完整性</h3>
<p>针对某一具体关系数据库的约束条件，反映某一具体应用所涉及的数据必须满足的<strong>语义要求</strong></p>
<p>关系模型应提供<strong>定义和检验</strong>这类完整性的机制，以便用统一的系统的方法处理它们，而不需由应用程序承担这一功能</p>
<h2 id="关系代数"><a class="markdownIt-Anchor" href="#关系代数">#</a> 关系代数</h2>
<p><strong>关系运算的记号</strong></p>
<ol>
<li>
<p>设关系模式为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>A</mi><mn>1</mn><mtext>，</mtext><mi>A</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>A</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(A1，A2，…，An)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，它的一个关系设为 R，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">t\in R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65418em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 表示 t 是 R 的一个元组，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">[</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t [A_i ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 则表示元组<em> t</em> 中相应于属性 Ai 的一个分量</p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>，</mtext><mi>t</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mtext>，</mtext><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">A，t[A]， \overline {A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.13333em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mclose">]</span><span class="mord cjk_fallback">，</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>，</p>
<ul>
<li>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo fence="true">{</mo><mi>A</mi><mi>i</mi><mn>1</mn><mtext>，</mtext><mi>A</mi><mi>i</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>A</mi><mi>i</mi><mi>k</mi><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">A= \left \{Ai1，Ai2，…，Aik\right \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>i</mi><mn>1</mn><mtext>，</mtext><mi>A</mi><mi>i</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>A</mi><mi>i</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">Ai1，Ai2，…，Aik</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mn>1</mn><mtext>，</mtext><mi>A</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>A</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">A1，A2，…，An</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">n</span></span></span></span> 中的一部分，则<em> A</em> 称为属性列或属性组。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">[</mo><mi>A</mi><mi>i</mi><mn>1</mn><mo stretchy="false">]</mo><mtext>，</mtext><mi>t</mi><mo stretchy="false">[</mo><mi>A</mi><mn>2</mn><mo stretchy="false">]</mo><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>t</mi><mo stretchy="false">[</mo><mi>A</mi><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t[A]=(t[Ai1]，t[A2]，…，t[Ak])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">1</span><span class="mclose">]</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mord">2</span><span class="mclose">]</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span> 表示元组<em> t</em> 在属性列 A 上诸分量的集合。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span> 则表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><mi>A</mi><mn>1</mn><mtext>，</mtext><mi>A</mi><mn>2</mn><mtext>，</mtext><mo>…</mo><mtext>，</mtext><mi>A</mi><mi>n</mi><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left\{ A1，A2，…，An\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">A</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">n</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span> 中去掉<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><mi>A</mi><mi>i</mi><mn>1</mn><mo separator="true">,</mo><mi>A</mi><mi>i</mi><mn>2</mn><mo>…</mo><mtext>，</mtext><mi>A</mi><mi>i</mi><mi>k</mi><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left\{ Ai1,Ai2…，Aik\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">A</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span> 后剩余的属性组。</li>
</ul>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><mi>t</mi><mi>r</mi><mi>t</mi><mi>s</mi></mo><mstyle mathsize="1.728em"><mo lspace="0em" rspace="0em">⌢</mo></mstyle></mover></mi></mrow><annotation encoding="application/x-tex">\overset{\LARGE{\frown}}{trts}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5330819200000003em;vertical-align:0em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.5330819200000003em;"><span style="top:-3.7279999999999998em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span><span class="mop"><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span></span></span></span><span style="top:-4.54308em;margin-left:0em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sizing reset-size3 size9"><span class="mrel">⌢</span></span></span></span></span></span></span></span></span></span></span></span></span>，R 为 n 目关系，S 为 m 目关系。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>r</mi><mo>∈</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">tr\in R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65418em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>s</mi><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">ts\in S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65418em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><mi>t</mi><mi>r</mi><mi>t</mi><mi>s</mi></mo><mstyle mathsize="1.728em"><mo lspace="0em" rspace="0em">⌢</mo></mstyle></mover></mi></mrow><annotation encoding="application/x-tex">\overset{\LARGE{\frown}}{trts}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5330819200000003em;vertical-align:0em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.5330819200000003em;"><span style="top:-3.7279999999999998em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span><span class="mop"><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span></span></span></span><span style="top:-4.54308em;margin-left:0em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sizing reset-size3 size9"><span class="mrel">⌢</span></span></span></span></span></span></span></span></span></span></span></span></span> 称为元组的连接。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><mi>t</mi><mi>r</mi><mi>t</mi><mi>s</mi></mo><mstyle mathsize="1.728em"><mo lspace="0em" rspace="0em">⌢</mo></mstyle></mover></mi></mrow><annotation encoding="application/x-tex">\overset{\LARGE{\frown}}{trts}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5330819200000003em;vertical-align:0em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.5330819200000003em;"><span style="top:-3.7279999999999998em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span><span class="mop"><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span></span></span></span><span style="top:-4.54308em;margin-left:0em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sizing reset-size3 size9"><span class="mrel">⌢</span></span></span></span></span></span></span></span></span></span></span></span></span> 是一个 n + m 列的元组，前 n 个分量为 R 中的一</p>
<p>个 n 元组，后 m 个分量为 S 中的一个 m 元组。</p>
</li>
<li>
<p>象集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Zx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">x</span></span></span></span></p>
<p>给定一个关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>X</mi><mtext>，</mtext><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(X，Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span>，X 和 Z 为属性组。当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">t[X]=x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> 时，x 在 R 中的象集为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo fence="true">{</mo><mi>t</mi><mo stretchy="false">[</mo><mi>Z</mi><mo stretchy="false">]</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mo>∈</mo><mi>R</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">x= \left\{t[Z]|t\in R,t[x]=x\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">]</span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span>，它表示<em> R</em> 中属性组 X 上值为<em> x</em> 的诸元组在上分量的集合</p>
</li>
</ol>
<p><strong>关系运算</strong></p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411041601528.png" alt=""></p>
<p><strong>选择</strong></p>
<blockquote>
<p>取出行</p>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411041640163.png" alt=""></p>
<p><strong>投影</strong></p>
<blockquote>
<p>取出列</p>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411051000832.png" alt=""></p>
<p><strong>连接</strong></p>
<blockquote>
<p>扩展 列、行</p>
</blockquote>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>⋈</mo><msub><mi>S</mi><mrow><mi>A</mi><mi>θ</mi><mi>B</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mi><mover><mo><mi>t</mi><mi>r</mi><mi>t</mi><mi>s</mi></mo><mstyle mathsize="1.728em"><mo lspace="0em" rspace="0em">⌢</mo></mstyle></mover></mi><mi mathvariant="normal">∣</mi><mi>t</mi><mi>r</mi><mo>∈</mo><mi>R</mi><mo>∧</mo><mi>t</mi><mi>s</mi><mo>∈</mo><mi>S</mi><mo>∧</mo><mi>t</mi><mi>r</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mi>θ</mi><mi>t</mi><mi>s</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">R\Join S_{A\theta B}=\left\{ \overset{\LARGE{\frown}}{trts}|tr\in R\wedge ts\in S∧tr[A]θts[B]\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68833em;vertical-align:-0.005em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4831119200000003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.5330819200000003em;"><span style="top:-3.7279999999999998em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span><span class="mop"><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span></span></span></span><span style="top:-4.54308em;margin-left:0em;"><span class="pstrut" style="height:3.7279999999999998em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sizing reset-size3 size9"><span class="mrel">⌢</span></span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mclose">]</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">}</span></span></span></span></span></span></p>
<ul>
<li>A 和 B：分别为<em> R</em> 和<em> S</em> 上度数相等且可比的属性组</li>
<li>θ：比较运算符</li>
</ul>
<p><strong>等值连接</strong></p>
<p>θ 为 “＝” 的连接运算称为等值连接</p>
<p><strong>自然连接</strong></p>
<p>自然连接是一种特殊的等值连接</p>
<ul>
<li>
<p>两个关系中进行比较的分量必须是相同的属性组</p>
</li>
<li>
<p>在结果中把<strong>重复的属性列去掉</strong></p>
</li>
</ul>
<p><strong>悬浮元组</strong></p>
<p>两个关系 R 和 S 在做自然连接时，关系<em> R</em> 中某些元组有可能在 S 中<strong>不存在</strong>公共属性上值相等的元组，这些元组称为悬浮元组。</p>
<p><strong>外连接</strong></p>
<p>如果把悬浮元组也保存在结果关系中，而在其他属性上<strong>填空值 (Null)</strong>，就叫做外连接</p>
<p><strong>除运算</strong></p>
<p>给定关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>X</mi><mtext>，</mtext><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R (X，Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>Y</mi><mtext>，</mtext><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(Y，Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mtext>，</mtext><mi>Y</mi><mtext>，</mtext><mi>Z</mi></mrow><annotation encoding="application/x-tex">X，Y，Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 为属性组。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 中的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 可以有不同的属性名，但必须出自相同的域集。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 的除运算得到一个新的关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中满足下列条件的元组在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 属性列上的投影：元组在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 上分量值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> 的象集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">Y_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 包含<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 上投影的集合</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411051000845.png" alt=""></p>
<p>先对 SC 关系在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Sno,Cno)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mclose">)</span></span></span></span> 属性上建立投影，然后逐一求出每一学生<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Sno)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mclose">)</span></span></span></span> 的象集，并检查这些象集是否包含 K</p>
<p>k：<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411051000578.png" alt="image-20241104172918463" style="zoom: 50%;" /></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="false"><msub><mo>∏</mo><mrow><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi></mrow></msub></mstyle><mo stretchy="false">(</mo><mi>S</mi><mi>C</mi><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">÷</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">{\textstyle \prod_{Sno,Cno}}(SC){\div}  K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.185818em;vertical-align:-0.43581800000000004em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord"><span class="mord">÷</span></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></p>
<h1 id="sql"><a class="markdownIt-Anchor" href="#sql">#</a> SQl</h1>
<h2 id="sql特点"><a class="markdownIt-Anchor" href="#sql特点">#</a> SQL 特点</h2>
<ol>
<li>
<p><strong>综合统一</strong>：SQL 语言集 DDL，DML，DCL 的功能于一体</p>
<p><strong>DDL（数据定义语言，Data Definition Language）</strong><br>
DDL 语句用于定义或修改数据库结构，包括数据库、表、视图等。常见的 DDL 命令有：</p>
<ul>
<li><code>CREATE</code> ：创建数据库、表、视图等。</li>
<li><code>ALTER</code> ：修改已有的数据库对象，例如添加、删除或修改表中的列。</li>
<li><code>DROP</code> ：删除数据库对象，如删除表或数据库。</li>
<li><code>TRUNCATE</code> ：清空表中所有数据，但保留表结构。</li>
</ul>
<p><strong>用途</strong>：主要用于定义数据库的结构。</p>
<p><strong>DML（数据操纵语言，Data Manipulation Language）</strong><br>
DML 语句用于操作数据，包括插入、更新、删除和查询数据。常见的 DML 命令有：</p>
<ul>
<li><code>INSERT</code> ：插入数据到表中。</li>
<li><code>UPDATE</code> ：更新表中的数据。</li>
<li><code>DELETE</code> ：删除表中的数据。</li>
<li><code>SELECT</code> ：查询表中的数据。</li>
</ul>
<p><strong>用途</strong>：主要用于增删改查数据库中的数据。</p>
<p><strong>DCL（数据控制语言，Data Control Language）</strong><br>
DCL 语句用于管理数据库的权限和安全性，控制用户对数据的访问。常见的 DCL 命令有：</p>
<ul>
<li><code>GRANT</code> ：授予用户特定的权限。</li>
<li><code>REVOKE</code> ：撤销用户的特定权限。</li>
</ul>
<p><strong>用途</strong>：主要用于数据库的访问控制和权限管理。</p>
</li>
<li>
<p><strong>高度非过程化</strong>，无需了解存储路径，存储路径的选择以及 SQL 的操作过程由系统自动完成</p>
</li>
<li>
<p><strong>面向集合的操作方式</strong></p>
</li>
<li>
<p><strong>SQL 既是自含式语言又是嵌入式语言</strong></p>
</li>
<li>
<p>语言简洁，易学易用</p>
</li>
</ol>
<h2 id="数据定义"><a class="markdownIt-Anchor" href="#数据定义">#</a> 数据定义</h2>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411051411984.png" alt=""></p>
<h3 id="模式"><a class="markdownIt-Anchor" href="#模式">#</a> 模式</h3>
<h4 id="定义"><a class="markdownIt-Anchor" href="#定义">#</a> 定义</h4>
<p><code>CREATE SCHEMA &lt;模式名&gt; AUTHORIZATION &lt;用户名&gt; [&lt;表定义子句&gt;|&lt;视图定义字句&gt;|&lt;授权定义子句&gt;]</code></p>
<p>即：在 <code>CREATE SCHEMA</code>  中可以接受 <code>CREATE TABLE,CREATE VIEW,GRANT</code>  子句</p>
<ul>
<li>如果没有指定 &lt;模式名&gt;，那么 &lt; 模式名 &gt; 隐含为 &lt; 用户名 &gt;</li>
</ul>
<p><strong>eg</strong>：为用户 ZHANG 创建一个模式 TEST，并且在其中定义一个表 TAB1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SCHEMA TEST <span class="keyword">AUTHORIZATION</span> ZHANG</span><br><span class="line">CREATER <span class="keyword">TABLE</span> TAB1(COL1 <span class="type">SMALLINT</span>,</span><br><span class="line">                   COL2 <span class="type">INT</span>,</span><br><span class="line">                   COL3 <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">                   COL4 <span class="type">NUMERIC</span>(<span class="number">10</span>, <span class="number">3</span>),<span class="comment">-- 共10位，整数部分7位，小数点后3位</span></span><br><span class="line">                   COL5 <span class="type">DECIMAL</span>(<span class="number">5</span>, <span class="number">2</span>)<span class="comment">-- 整数部分加小数部分总长度是5，小数部分长度是2，如果超过2会发生截断，不足2会补齐</span></span><br><span class="line">                  );</span><br></pre></td></tr></table></figure>
<h4 id="删除"><a class="markdownIt-Anchor" href="#删除">#</a> 删除</h4>
<p><code>Drop SCHEMA &lt;模式名&gt;&lt;CASCADE|RESTRICT&gt;</code></p>
<ul>
<li><code>CASCADE</code>  表示同时把该模式中所有的数据库对象全部删除</li>
<li><code>RESTRICT</code>  表示如果模式中已经定义了下属的数据库对象，则拒绝执行删除该语句</li>
</ul>
<h3 id="基本表"><a class="markdownIt-Anchor" href="#基本表">#</a> 基本表</h3>
<h4 id="定义-2"><a class="markdownIt-Anchor" href="#定义-2">#</a> 定义</h4>
<h5 id="表"><a class="markdownIt-Anchor" href="#表">#</a> 表：</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CEATE <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>(<span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [列级完整性约束条件]</span><br><span class="line">                  [,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>[列级完整性约束条件]]</span><br><span class="line">                  ...</span><br><span class="line">                  [,<span class="operator">&lt;</span>表级完整性约束条件<span class="operator">&gt;</span>]);</span><br></pre></td></tr></table></figure>
<p><strong>eg</strong>：创建一个 “课程” 表 Course</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Course(</span><br><span class="line">    Cno <span class="type">CHAR</span>(<span class="number">4</span>) <span class="keyword">PRIMARY</span> KEY, <span class="comment">-- 列级完整性约束条件，Cno是主码</span></span><br><span class="line">    Cname <span class="type">CHAR</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">-- 列级完整性约束条件，Cname不能取空值</span></span><br><span class="line">    Cpno <span class="type">CHAR</span>(<span class="number">4</span>),</span><br><span class="line">    Ccredit <span class="type">SMALLINT</span>,</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY(Cpno) <span class="keyword">REFERENCES</span> Course(Cno) <span class="comment">-- 表级完整性约束条件，Cpno是外码，被参照表是Course，被参照列是Cno</span></span><br><span class="line">    <span class="comment">/*由此可见参照表和被参照表可以是同一个表*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h5 id="表所属模式"><a class="markdownIt-Anchor" href="#表所属模式">#</a> 表所属模式：</h5>
<p><strong>法一</strong>：在表名中明显给出模式名</p>
<p>eg： <code>CREATE TABLE &quot;S-T&quot;.Student(...);</code>  表示 <code>Student</code>  所属的模式是 <code>S-T</code></p>
<p><strong>法二</strong>：在创建模式语句同时建立表，例子见模式定义</p>
<p><strong>法三</strong>：根据搜索路径来确定对象所属模式</p>
<p>搜索路径默认是 <code>$user, PUBLIC</code> ，表示先搜索与用户名相同的模式名，如果该模式名不存在，就使用 <code>PUBLIC</code>  模式</p>
<p>数据库管理员也可以自己设置搜索路径，eg： <code>SET search_path To &quot;S-T&quot;, PUBLIC;</code> ，然后定义基本表；那么如果 <code>S-T</code>  存在基本表就定义在了 <code>S-T</code>  模式中</p>
<h4 id="修改"><a class="markdownIt-Anchor" href="#修改">#</a> 修改</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ALERT <span class="keyword">TABLE</span><span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">ADD</span> [<span class="keyword">COLUMN</span>] <span class="operator">&lt;</span>新列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [完整性约束]]</span><br><span class="line">[<span class="keyword">ADD</span> <span class="operator">&lt;</span>表级完整性约束<span class="operator">&gt;</span>]</span><br><span class="line">[<span class="keyword">DROP</span> [<span class="keyword">COLUMN</span>] <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> [CASCADE<span class="operator">|</span>RESTRICT]]</span><br><span class="line">[<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span><span class="operator">&lt;</span>完整性约束名<span class="operator">&gt;</span> [CASCADE<span class="operator">|</span>RESTRICT]]</span><br><span class="line">[<span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span><span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure>
<h4 id="删除-2"><a class="markdownIt-Anchor" href="#删除-2">#</a> 删除</h4>
<p><code>DROP TABLE &lt;表名&gt; [CASCADE|RESTRICT];</code></p>
<h3 id="索引"><a class="markdownIt-Anchor" href="#索引">#</a> 索引</h3>
<h4 id="建立"><a class="markdownIt-Anchor" href="#建立">#</a> 建立</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>] [CLUSTER] INDEX <span class="operator">&lt;</span>索引名<span class="operator">&gt;</span></span><br><span class="line"><span class="comment">-- UNIQUE表示每一个索引值只对应唯一的数据记录</span></span><br><span class="line"><span class="comment">-- CLUSTER表示建立的索引是聚簇索引</span></span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>(<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[<span class="operator">&lt;</span>次序<span class="operator">&gt;</span>][,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[<span class="operator">&lt;</span>次序<span class="operator">&gt;</span>]]...);</span><br></pre></td></tr></table></figure>
<p>次序： <code>ASC</code> （升序）， <code>DESC</code> （降序）；默认 <code>ASC</code></p>
<p><strong>eg</strong>： <code>CREATE UNIQUE INDEX Scno ON SC (Sno ASC, Cno DESC)</code> ，表示 SC 表按学号升序和课程号降序建立唯一索引</p>
<h4 id="修改-2"><a class="markdownIt-Anchor" href="#修改-2">#</a> 修改</h4>
<p><code>ALTER INDEX &lt;旧索引名&gt; RENAME TO &lt;新索引名&gt;</code></p>
<h4 id="删除-3"><a class="markdownIt-Anchor" href="#删除-3">#</a> 删除</h4>
<p><code>DROP INDEX &lt;索引名&gt;</code></p>
<h2 id="数据查询"><a class="markdownIt-Anchor" href="#数据查询">#</a> 数据查询</h2>
<h3 id="单表查询"><a class="markdownIt-Anchor" href="#单表查询">#</a> 单表查询</h3>
<h4 id="选择表中的若干列"><a class="markdownIt-Anchor" href="#选择表中的若干列">#</a> 选择表中的若干列</h4>
<ol>
<li>
<p>查询指定列：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列表题别名][,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列标题别名]]... <span class="comment">-- 目标表达式可以是算术表达式、字符串常量、函数等</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>eg</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname NAME, <span class="string">&#x27;Year of Birth:&#x27;</span>BIRTH, <span class="number">2014</span><span class="operator">-</span>Sage BIRTHDAY, <span class="built_in">LOWER</span>(Sdept) DEPARTMENT </span><br><span class="line"><span class="comment">-- 字符串常量&#x27;Year of Birth:&#x27;列的别名是BIRTH</span></span><br><span class="line"><span class="comment">-- 算术表达式2014-Sage列的别名是BIRTHDAY</span></span><br><span class="line"><span class="comment">-- 函数LOWER(Sdept)列的别名是DEPARTMENT </span></span><br><span class="line"><span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>查询全部列：</p>
<p><code>SELECT *</code></p>
</li>
</ol>
<h4 id="选择表中若干元组"><a class="markdownIt-Anchor" href="#选择表中若干元组">#</a> 选择表中若干元组</h4>
<ol>
<li>
<p>消除取值重复的行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列表题别名][,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列标题别名]]...</span><br><span class="line"><span class="comment">-- DISTINCT消除重复的行</span></span><br><span class="line"><span class="comment">-- ALL保留重复的行</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>查询满足条件的元组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列表题别名][,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列标题别名]]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span> <span class="comment">-- WHERE语句实现</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>确定集合： <code>IN/NOT IN</code></p>
</li>
<li>
<p>字符串匹配： <code>[NOT] LIKE'&lt;匹配串&gt;' [ESCAPE '&lt;换码字符&gt;']</code></p>
<ul>
<li>
<p>&lt;匹配串&gt; 中可以含有通配符 %（表示任意长度的字符串，长度可以为 0）和_（表示任意单个字符）</p>
</li>
<li>
<p>如果匹配串中不含通配符， <code>LIKE</code>  可以用 <code>=</code>  代替</p>
</li>
<li>
<p>如果要查询的字符串中本身含有 % 或_，那么就要用 <code>[ESCAPE '&lt;换码字符&gt;']</code>  进行转义</p>
</li>
</ul>
<p><strong>eg</strong>：查询以 &quot;DB_&quot; 开头，且倒数第三个字符为 i 的课程的详细信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Course</span><br><span class="line"><span class="keyword">WHERE</span> Cname <span class="keyword">LIKE</span><span class="string">&#x27;DB\_%i_ _&#x27;</span> <span class="keyword">ESCAPE</span><span class="string">&#x27;\&#x27;</span> </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>空值的查询： <code>IS [NOT] NULL</code></p>
</li>
<li>
<p>多重条件查询： <code>AND/OR(AND优先级高于OR)</code></p>
</li>
</ul>
</li>
</ol>
<h4 id="order-by"><a class="markdownIt-Anchor" href="#order-by">#</a>  <code>ORDER BY</code></h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列表题别名][,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列标题别名]]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>] <span class="comment">-- ASC升序，DESC降序；默认为ASC</span></span><br></pre></td></tr></table></figure>
<h4 id="聚集函数"><a class="markdownIt-Anchor" href="#聚集函数">#</a> 聚集函数</h4>
<h4 id="group-by"><a class="markdownIt-Anchor" href="#group-by">#</a>  <code>GROUP BY</code></h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列表题别名][,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列标题别名]]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span> [<span class="keyword">HAVING</span><span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>] <span class="comment">-- 将查询结果按某一列或多列的值进行分组，HAVING语句指定筛选条件 </span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]</span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mtext>注：</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{red}{注：}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord" style="color:red;"><span class="mord cjk_fallback" style="color:red;">注</span><span class="mord cjk_fallback" style="color:red;">：</span></span></span></span></span> WHERE 作用于基本表或者视图；HAVING 作用于组</p>
<p>例：查询每个部门的总的薪水数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DEPT, <span class="built_in">sum</span>(SALARY) <span class="keyword">AS</span> total</span><br><span class="line"><span class="keyword">FROM</span> STAFF</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> DEPT <span class="comment">-- 是每个部门的而不是整个公司的</span></span><br></pre></td></tr></table></figure>
<h3 id="连接查询"><a class="markdownIt-Anchor" href="#连接查询">#</a> 连接查询</h3>
<h4 id="等值与非等值连接查询"><a class="markdownIt-Anchor" href="#等值与非等值连接查询">#</a> 等值与非等值连接查询</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*连接查询的WHERE子句中用来连接两个表的条件称为连接条件或连接谓词*/</span></span><br><span class="line"><span class="comment">-- 连接谓词：</span></span><br><span class="line">[<span class="operator">&lt;</span>表名<span class="number">1</span><span class="operator">&gt;</span>.]<span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span><span class="operator">&lt;</span>比较运算符<span class="operator">&gt;</span>[<span class="operator">&lt;</span>表名<span class="number">2</span><span class="operator">&gt;</span>.]<span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span></span><br><span class="line">[<span class="operator">&lt;</span>表名<span class="number">1</span><span class="operator">&gt;</span>.]<span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span><span class="keyword">BETWEEN</span>[<span class="operator">&lt;</span>表名<span class="number">2</span><span class="operator">&gt;</span>.]<span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span><span class="keyword">AND</span>[<span class="operator">&lt;</span>表名<span class="number">3</span><span class="operator">&gt;</span>.]<span class="operator">&lt;</span>列名<span class="number">3</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>自然连接：把目标列中重复的属性列去掉</p>
<h4 id="自身连接"><a class="markdownIt-Anchor" href="#自身连接">#</a> 自身连接</h4>
<p>给同一个表取两个别名，按照不同表的连接方式连接即可</p>
<h4 id="外连接"><a class="markdownIt-Anchor" href="#外连接">#</a> 外连接</h4>
<p>连接两个表的时候，可能有的元素因为不满足条件，没有出现在最终的表格中；利用外连接可以在不满足条件的地方填上 NULL。左外连接，保留左边的表，右边的表不足的时候填上 NULL；右外连接同理。</p>
<p><strong>eg</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="number">1</span><span class="operator">&gt;</span> <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span>表名<span class="number">2</span><span class="operator">&gt;</span> <span class="keyword">ON</span>([表名<span class="number">1.</span>]<span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;=</span>[表名<span class="number">2.</span>]<span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span>) <span class="comment">-- 左外连接</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="number">1</span><span class="operator">&gt;</span> <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span>表名<span class="number">2</span><span class="operator">&gt;</span> <span class="keyword">ON</span>([表名<span class="number">1.</span>]<span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;=</span>[表名<span class="number">2.</span>]<span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span>) <span class="comment">-- 右外连接</span></span><br><span class="line"><span class="comment">-- 可以用USING来去掉结果中的重复值：FROM &lt;表名1&gt; RIGHT OUTER JOIN &lt;表名2&gt; USING(列名)</span></span><br></pre></td></tr></table></figure>
<h4 id="多表连接"><a class="markdownIt-Anchor" href="#多表连接">#</a> 多表连接</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="嵌套查询"><a class="markdownIt-Anchor" href="#嵌套查询">#</a> 嵌套查询</h4>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mtext>注：</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{red}{注：}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord" style="color:red;"><span class="mord cjk_fallback" style="color:red;">注</span><span class="mord cjk_fallback" style="color:red;">：</span></span></span></span></span> 子查询的 SELECT 语句中不能使用 ORDER BY</p>
<ol>
<li>
<p>带有 IN 的子查询</p>
<p>不相关子查询：子查询条件不依赖父节点</p>
<p>相关子查询：子查询条件依赖父节点</p>
<p><strong>eg</strong>：找出每个学生超过他自己选修课程平均成绩的课程号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*Sno--学号 Cno--课程号 SC--存储学号、课程号、成绩的表格 */</span></span><br><span class="line"><span class="keyword">SELECT</span> Sno, Cno</span><br><span class="line"><span class="keyword">FROM</span> SC x</span><br><span class="line"><span class="keyword">WHERE</span> GRADE <span class="operator">&gt;=</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(GRADE)</span><br><span class="line">                <span class="keyword">FROM</span> SC y</span><br><span class="line">                <span class="keyword">WHERE</span> x.Sno <span class="operator">=</span> y.Sno <span class="comment">-- 表示是同一个学生的成绩</span></span><br><span class="line">               );</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>带有比较运算符的子查询</p>
</li>
<li>
<p>带有 ANY（SOME）或 ALL 的子查询</p>
<ul>
<li>
<p>ANY – 某个 ； ALL – 所有</p>
</li>
<li>
<p>可以用聚集函数 + 比较运算符代替 ANY/ALL，且聚集函数效率更高</p>
<p>eg： <code>&lt;ANY 等价于 &lt;MAX</code></p>
</li>
</ul>
</li>
<li>
<p>带有 EXISTS/NOT EXISTS 的子查询</p>
<p>EXISTS：如果内层查询非空，返回真；否则返回假</p>
<p>NOT EXISTS：如果内层非空，返回假；否则返回真</p>
<p>由于没有全称量词，所以需要将题目转换成等价的用存在量词的形式</p>
<p><strong>eg</strong>：查询选修了全部课程的学生姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*等价于查询 找到学生 没有一门课是ta不选的*/</span></span><br><span class="line"><span class="keyword">SELECT</span> Sname</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="comment">-- 不存在</span></span><br><span class="line">	(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> Course</span><br><span class="line">        <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="comment">-- 有一门课程没有ta</span></span><br><span class="line">        	(</span><br><span class="line">                <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">                <span class="keyword">FROM</span> SC</span><br><span class="line">                <span class="keyword">WHERE</span> Sno <span class="operator">=</span> Student.Sno <span class="keyword">AND</span> Cno <span class="operator">=</span> Course.Cno</span><br><span class="line">            )</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>
<p><strong>eg</strong>：查询至少选修了学生 201215122 选修的全部课程的学生号码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*等价于查询学生x： 不存在这样的课程y 学生201215122选修了y 但是学生x没选修*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Sno</span><br><span class="line"><span class="keyword">FROM</span> SC SCX <span class="comment">-- 查询学生x</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">	(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="comment">-- 查询课程y</span></span><br><span class="line">        <span class="keyword">FROM</span> SC SCY</span><br><span class="line">        <span class="keyword">WHERE</span> SCY.Sno <span class="operator">=</span> <span class="string">&#x27;201215122&#x27;</span> <span class="keyword">AND</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="comment">-- 20121522选修了</span></span><br><span class="line">                                (</span><br><span class="line">                                    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">                                    <span class="keyword">FROM</span> SC SCZ</span><br><span class="line">                                    <span class="keyword">WHERE</span> SCZ.Sno <span class="operator">=</span> SCX.Sno <span class="keyword">AND</span> SCZ.Cno <span class="operator">=</span> SCY.Cno <span class="comment">-- 就是查找学生x的学号是否在里面，以及201215122是否选修了这门课程；</span></span><br><span class="line"><span class="comment">-- 如果发现结果是后面的判断成立，前面的判断不成立，即“学生201215122选修了y 但是学生x没选修”，就返回空，又因为是NOT EXISTS所以表达式是True；于是第二层判断是True，那么又因为是NOT EXISTS所以第二层整体式False，那么这个就不是要找的学生x</span></span><br><span class="line">                                )</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="集合查询"><a class="markdownIt-Anchor" href="#集合查询">#</a> 集合查询</h3>
<p>集合操作主要包括：并 <code>UNION</code> ，交 <code>INTERSECT</code> ，差 <code>EXCEPT</code></p>
<h3 id="基于派生表的查询"><a class="markdownIt-Anchor" href="#基于派生表的查询">#</a> 基于派生表的查询</h3>
<p>子查询不仅可以出现在 WHERE 子句中，还可以出现在 FROM 子句中，这时子查询生成的临时派生表成为主查询的查询对象</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>]<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列表题别名][,<span class="operator">&lt;</span>目标表达式<span class="operator">&gt;</span>[列标题别名]]...</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>表名或视图名<span class="operator">&gt;</span>...]<span class="operator">|</span>(<span class="operator">&lt;</span><span class="keyword">SELECT</span>语句<span class="operator">&gt;</span>[<span class="keyword">AS</span>]<span class="operator">&lt;</span>别名<span class="operator">&gt;</span>)<span class="comment">-- 通过FROM生成派生表时AS关键字可以省略，但必须为派生表指定一个别名</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span> [<span class="keyword">HAVING</span><span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>] </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]</span><br></pre></td></tr></table></figure>
<p><strong>eg</strong>：找出每个学生超过自己选修课程平均成绩的课程号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno, Cno</span><br><span class="line"><span class="keyword">FROM</span> SC, (<span class="keyword">SELECT</span> Sno, <span class="built_in">AVG</span>(Grade)</span><br><span class="line">          <span class="keyword">FROM</span> SC</span><br><span class="line">          <span class="keyword">GROUP</span> <span class="keyword">BY</span> Sno</span><br><span class="line">         )<span class="keyword">AS</span> Avg_sc(avg_sno, avg_grade)</span><br><span class="line"><span class="keyword">WHERE</span> SC.Sno <span class="operator">=</span> Avg_sc.avg_sno <span class="keyword">AND</span> SC.Grade <span class="operator">&gt;=</span> Avg_sc.avg_grade;</span><br></pre></td></tr></table></figure>
<h2 id="数据更新"><a class="markdownIt-Anchor" href="#数据更新">#</a> 数据更新</h2>
<h3 id="插入数据"><a class="markdownIt-Anchor" href="#插入数据">#</a> 插入数据</h3>
<p>插入元组：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>属性列<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>属性列<span class="number">2</span><span class="operator">&gt;</span>]...)]</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="operator">&lt;</span>常量<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>常量<span class="number">2</span><span class="operator">&gt;</span>]...);</span><br></pre></td></tr></table></figure>
<ol>
<li><code>INTO</code>  中没有出现的属性列默认取空值</li>
<li>如果 <code>INTO</code>  语句中没有指明任何属性列名，则新插入的元组必须在每个属性列上均有值</li>
<li><code>VALUES</code>  子句对新元组的各属性赋值，字符串常数要用单引号括起来</li>
</ol>
<p>插入子查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>属性列<span class="number">1</span><span class="operator">&gt;</span>)[,<span class="operator">&lt;</span>属性列<span class="number">2</span><span class="operator">&gt;</span>...]]</span><br><span class="line">子查询；<span class="comment">-- SELECT语句</span></span><br></pre></td></tr></table></figure>
<h3 id="修改数据"><a class="markdownIt-Anchor" href="#修改数据">#</a> 修改数据</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span><span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">SET</span><span class="operator">&lt;</span>列名<span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>列名<span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>]...</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure>
<h3 id="删除数据"><a class="markdownIt-Anchor" href="#删除数据">#</a> 删除数据</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span><span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">WHERE</span><span class="operator">&lt;</span>条件<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure>
<h2 id="视图"><a class="markdownIt-Anchor" href="#视图">#</a> 视图</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span>视图名<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>]...)]</span><br><span class="line"><span class="keyword">AS</span><span class="operator">&lt;</span>子查询<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION] <span class="comment">-- 表示在对视图进行操作时保证更新、插入或删除的行满足视图中子查询中的条件表达式</span></span><br></pre></td></tr></table></figure>
<ol>
<li>组成视图的属性名或者全省略或者全部指定</li>
<li>以下情况必须明确指定组成视图的所有列名
<ul>
<li>某个列式聚集函数或列表达式</li>
<li>多表连接时选出了几个同名列作为视图的字段</li>
<li>需要在视图中为某个列启用新的更合适的名字</li>
</ul>
</li>
<li>把对视图的操作都转换成对基本表的操作</li>
</ol>
<p><strong>优点：</strong></p>
<ol>
<li>能多视角看待同一数据</li>
<li>简化用户操作</li>
<li>对机密数据提供安全保护</li>
<li>对重构数据库提供了一定程度的逻辑独立性</li>
</ol>
<h1 id="数据库安全性"><a class="markdownIt-Anchor" href="#数据库安全性">#</a> 数据库安全性</h1>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410170910811.jpg" alt=""></p>
<p>数据库安全性主要包括用户<strong>身份鉴别</strong>、<strong>多层存取控制</strong>、<strong>审计</strong>、<strong>视图</strong>和<strong>数据加密</strong>等安全技术。</p>
<p><strong>自主存取控制</strong>与<strong>强制存取控制</strong>共同构成数据库管理系统的安全机制</p>
<h2 id="身份鉴别"><a class="markdownIt-Anchor" href="#身份鉴别">#</a> 身份鉴别</h2>
<p>静态口令鉴别：静态口令一般由用户自己设定，这些口令是静态不变的</p>
<p>动态口令鉴别：口令是动态变化的，每次鉴别时均需使用动态产生的新口令登录数据库管理系统，即采用一次一密的方法</p>
<p>生物特征鉴别：通过生物特征进行认证的技术， 生物特征如指纹、虹膜和掌纹等</p>
<p>智能卡鉴别：智能卡是一种<strong>不可复制的硬件</strong>，内置集成电路的芯片，具有硬件加密功能</p>
<h2 id="自主存取控制dac"><a class="markdownIt-Anchor" href="#自主存取控制dac">#</a> 自主存取控制 DAC</h2>
<ul>
<li>
<p>用户对不同的数据对象有不同的存取权限</p>
</li>
<li>
<p>用户还可将其拥有的存取权限转授给其他用户</p>
</li>
</ul>
<p>通过 SQL 的<strong> GRANT</strong> 语句和<strong> REVOKE</strong> 语句实现对<strong>数据</strong>的操作权限</p>
<h3 id="grant"><a class="markdownIt-Anchor" href="#grant">#</a> GRANT</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>]…</span><br><span class="line"><span class="keyword">TO</span> <span class="operator">&lt;</span>用户<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>用户<span class="operator">&gt;</span>]... <span class="comment">-- PUBLIC表示所有用户</span></span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION]; <span class="comment">-- 获得该权限的用户可以把权限授予其他用户 </span></span><br></pre></td></tr></table></figure>
<p>具体实例：</p>
<p><strong>全部权限</strong>的授予</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILIGES</span><br></pre></td></tr></table></figure>
<p>授予<strong>所有用户</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> </span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">TABLE</span> SC </span><br><span class="line"><span class="keyword">TO</span> PUBLIC;</span><br></pre></td></tr></table></figure>
<p>对<strong>属性列</strong>的授权</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span>(Sno), <span class="keyword">SELECT</span> <span class="comment">-- 明确指出列名</span></span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">TABLE</span> Student </span><br><span class="line"><span class="keyword">TO</span> U4;</span><br></pre></td></tr></table></figure>
<h3 id="revoke"><a class="markdownIt-Anchor" href="#revoke">#</a> REVOKE</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]...</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span><span class="operator">&lt;</span>对象名<span class="operator">&gt;</span>]…</span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>用户<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>用户<span class="operator">&gt;</span>]...[CASCADE <span class="operator">|</span> RESTRICT];</span><br></pre></td></tr></table></figure>
<p>具体实例：</p>
<p>收回<strong>所有用户</strong>对表 SC 的查询权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span> </span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">TABLE</span> SC </span><br><span class="line"><span class="keyword">FROM</span> PUBLIC;</span><br></pre></td></tr></table></figure>
<p>把用户 U5 对 SC 表的 INSERT 权限收回</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">INSERT</span> </span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">TABLE</span> SC </span><br><span class="line"><span class="keyword">FROM</span> U5 </span><br><span class="line">CASCADE;<span class="comment">-- 系统只收回直接或间接从U5处获得的权限，如果U6从U5获得了INSERT权限，但是同时从U4获得了INSERT权限，则U6仍有INSERT权限</span></span><br></pre></td></tr></table></figure>
<p>对<strong>创建数据库模式</strong>一类的数据库对象的授权则由数据库管理员<strong>在创建用户时实现</strong>。</p>
<h3 id="创建用户"><a class="markdownIt-Anchor" href="#创建用户">#</a> 创建用户</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="operator">&lt;</span>username<span class="operator">&gt;</span> </span><br><span class="line">[<span class="keyword">WITH</span>][DBA<span class="operator">|</span>RESOURCE<span class="operator">|</span><span class="keyword">CONNECT</span>];</span><br></pre></td></tr></table></figure>
<ul>
<li>只有系统的超级用户才有创建一个新的数据库用户的权限</li>
<li>默认拥有 CONNECT 权限</li>
<li>拥有 RESOURCE 的用户可以创建基本表和视图，但不能创建模式</li>
<li>拥有 DBA 的用户时超级用户</li>
</ul>
<h3 id="角色"><a class="markdownIt-Anchor" href="#角色">#</a> 角色</h3>
<p>角色是权限的集合</p>
<p>角色的创建：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ROLE <span class="operator">&lt;</span>角色名<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>给角色授权:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]… </span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span>对象名 </span><br><span class="line"><span class="keyword">TO</span> <span class="operator">&lt;</span>角色<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>角色<span class="operator">&gt;</span>]…</span><br></pre></td></tr></table></figure>
<p>将一个角色授予其他的角色或用户:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="operator">&lt;</span>角色<span class="number">1</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>角色<span class="number">2</span><span class="operator">&gt;</span>]… </span><br><span class="line"><span class="keyword">TO</span> <span class="operator">&lt;</span>角色<span class="number">3</span><span class="operator">&gt;</span>[,<span class="operator">&lt;</span>用户<span class="number">1</span><span class="operator">&gt;</span>]… </span><br><span class="line">[<span class="keyword">WITH</span> ADMIN OPTION]<span class="comment">-- 表示获得某种权限的角色或用户可以把这种权限再授予其他角色</span></span><br></pre></td></tr></table></figure>
<p>角色权限的收回：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="operator">&lt;</span>权限<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>权限<span class="operator">&gt;</span>]…</span><br><span class="line"><span class="keyword">ON</span> <span class="operator">&lt;</span>对象类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>对象名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>角色<span class="operator">&gt;</span>[,<span class="operator">&lt;</span>角色<span class="operator">&gt;</span>]…</span><br></pre></td></tr></table></figure>
<h2 id="强制存取控制mac"><a class="markdownIt-Anchor" href="#强制存取控制mac">#</a> 强制存取控制 MAC</h2>
<ul>
<li>每一个数据对象被标以一定的密级</li>
<li>每一个用户也被授予某一个级别的许可证</li>
</ul>
<p>该机制只通过对数据的存储权限来进行安全控制，而数据本身并无安全标记。</p>
<p>全部实体被分成主体和客体：</p>
<p><strong>主体</strong>：系统中的活动实体，包括数据库管理系统所管理的实际用户和用户的各种进程</p>
<p><strong>客体</strong>：系统中的被动实体，受主体操纵，包括 文件、基本表、索引、视图</p>
<p>对于主体和客体，DBMS 为它们每个实例指派一个<strong>敏感度</strong></p>
<p>敏感度标记分成若干级别：</p>
<ul>
<li>
<p>绝密（Top Secret，TS）</p>
</li>
<li>
<p>机密（Secret，S）</p>
</li>
<li>
<p>可信（Confidential，C）</p>
</li>
<li>
<p>公开（Public，P）</p>
</li>
</ul>
<p><strong>TS&gt;=S&gt;=C&gt;=P</strong></p>
<p>主体的敏感度标记称为<strong>许可证级别</strong>；客体的敏感度标记称为<strong>密级</strong></p>
<p><strong>TCSEC/TDI 安全级别划分</strong>：</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411061333961.png" alt=""></p>
<p><strong>C1 级</strong></p>
<ul>
<li>能够实现对用户和数据的分离，进行<strong>自主存取控制（DAC）</strong>，保护或限制用户权限的传播。</li>
</ul>
<p><strong>C2 级</strong></p>
<ul>
<li>
<p>安全产品的最低档次</p>
</li>
<li>
<p>提供受控的存取保护，将 C1 级的 DAC 进一步<strong>细化</strong>，以<strong>个人身份注册</strong>负责，并实施<strong>审计</strong>和<strong>资源隔离</strong></p>
</li>
</ul>
<p><strong>B1 级</strong></p>
<ul>
<li>
<p>标记安全保护。“安全” 或 “可信的” 产品。</p>
</li>
<li>
<p>对系统的数据加以标记，对标记的主体和客体<strong>实施强制存取控制（MAC）</strong>、<strong>审计</strong>等安全机制</p>
</li>
</ul>
<p><strong>CC 评估保证级（EAL）划分</strong>：</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411061333925.png" alt=""></p>
<h2 id="视图机制"><a class="markdownIt-Anchor" href="#视图机制">#</a> 视图机制</h2>
<p>把要保密的数据对无权存取这些数据的用户<strong>隐藏</strong>起来，对数据提供一定程度的安全保护</p>
<h2 id="审计机制"><a class="markdownIt-Anchor" href="#审计机制">#</a> 审计机制</h2>
<p>启用一个专用的审计日志，将用户对数据库的所有操作<strong>记录</strong>在上面。</p>
<p>审计员利用审计日志，监控数据库中的各种行为，找出非法存取数据的人、时间和内容。</p>
<p><strong>C2</strong> 以上安全级别的 DBMS<strong> 必须具有</strong>审计功能。</p>
<p><strong>审计事件</strong>：服务器事件，系统权限，语句事件，模式对象事件</p>
<p>防止审计员误删审计记录，审计日志必须<strong>先转储后删除</strong></p>
<p><strong>只</strong>允许审计员查阅和转储审计记录，不允许任何用户新增和修改审计记录等</p>
<h3 id="设置和取消审计"><a class="markdownIt-Anchor" href="#设置和取消审计">#</a> 设置和取消审计</h3>
<p>AUDIT 语句：设置审计功能</p>
<p>NOAUDIT 语句：取消审计功能</p>
<p>实例：</p>
<p>对修改 SC 表结构或修改 SC 表数据的操作进行审计</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AUDIT <span class="keyword">ALTER</span>,<span class="keyword">UPDATE</span> </span><br><span class="line"><span class="keyword">ON</span> SC;</span><br></pre></td></tr></table></figure>
<p>取消对 SC 表的一切审计</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NOAUDIT <span class="keyword">ALTER</span>,<span class="keyword">UPDATE</span> </span><br><span class="line"><span class="keyword">ON</span> SC;</span><br></pre></td></tr></table></figure>
<h2 id="数据加密"><a class="markdownIt-Anchor" href="#数据加密">#</a> 数据加密</h2>
<p>数据加密：防止数据库中数据在存储和传输中失密的有效手段</p>
<p>加密的基本思想：根据一定的算法将原始数据 —<strong> 明文</strong>变换为不可直接识别的格式 —<strong> 密文</strong></p>
<p>加密方法：</p>
<ul>
<li>
<p>存储加密</p>
<ul>
<li>
<p>透明存储加密</p>
<ol>
<li>内核级加密保护方式，对用户完全透明</li>
<li>将数据在写到磁盘时对数据进行加密，授权用户读取数据时再对其进行解密</li>
<li>数据库的应用程序不需要做任何修改，只需在创建表语句中说明加密的字段即可</li>
<li>内核级加密方法：性能较好，安全完备性较高</li>
</ol>
</li>
<li>
<p>非透明存储加密：通过多个加密函数实现</p>
</li>
</ul>
</li>
<li>
<p>传输加密</p>
<ul>
<li>
<p>链路加密</p>
<ol>
<li>在链路层进行加密</li>
<li>传输信息由报头和报文两部分组成，报文和报头均加密</li>
</ol>
</li>
<li>
<p>端到端加密</p>
<ol>
<li>在发送端加密，接收端解密</li>
<li>只加密报文不加密报头</li>
<li>所需密码设备数量相对较少，容易被非法监听者发现并从中获取敏感信息</li>
</ol>
</li>
</ul>
</li>
</ul>
<h1 id="数据库完整性"><a class="markdownIt-Anchor" href="#数据库完整性">#</a> 数据库完整性</h1>
<p>DBMS 的完整性控制机制具有：定义功能、检查功能、违约处理功能。</p>
<h2 id="实体完整性-2"><a class="markdownIt-Anchor" href="#实体完整性-2">#</a> 实体完整性</h2>
<p>关系模型中以<strong>主码</strong>作为唯一性标识，主属性不能取空值。</p>
<p>定义主码：</p>
<ul>
<li>如果只有一个属性是码，可以在列后加上 <code>PRIMARY KEY</code> ，也可以在表的最后表级定义主码， <code>PRIMARY KEY (Sno)</code></li>
<li>如果多个属性是主码，只能在标的最后表级定义主码， <code>PRIMARY KEY (Sno,Cno)</code></li>
</ul>
<h3 id="实体完整性的检查"><a class="markdownIt-Anchor" href="#实体完整性的检查">#</a> 实体完整性的检查</h3>
<p>插入或对主码列进行更新操作时，进行实体完整性规则检查：</p>
<ol>
<li>
<p>检查主码的各个属性是否为空，只要有一个为空就拒绝插入或修改。</p>
</li>
<li>
<p>检查主码值是否唯一，如果不唯一则拒绝插入或修改。</p>
</li>
</ol>
<p>检查记录中的主码，如果使用全表扫描，非常耗时，所以数据库管理系统一般会在主码上自动建立一个索引，通过 B + 树索引查找基本表中是否已经存在新的主码值</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410170910597.jpg" alt=""></p>
<h2 id="参照完整性-2"><a class="markdownIt-Anchor" href="#参照完整性-2">#</a> 参照完整性</h2>
<p>外码或者取<strong>空值</strong>，或者等于对应元组的某个<strong>存在的主码值</strong></p>
<p>在表级定义参照完整性： <code>FOREIGN KEY (Cno) REFERENCES Course(Cno)</code></p>
<h3 id="参照完整性的检查"><a class="markdownIt-Anchor" href="#参照完整性的检查">#</a> 参照完整性的检查</h3>
<p>可能得违规行为：</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410170913840.png" alt=""></p>
<p>处理方式：</p>
<ul>
<li>拒绝执行 <code>NO ACTION</code> ，该策略为<strong>默认</strong>策略</li>
<li>级联操作 <code>CASCADE</code> ，当删除或修改被参照表的一个元组导致参照表的不一致时，删除或修改参照表中的所有导致不一致的元组</li>
<li>设置为空值</li>
</ul>
<p>显示说明参照完整性的违规处理情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC</span><br><span class="line">( </span><br><span class="line">    Sno <span class="type">CHAR</span>(<span class="number">9</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>，</span><br><span class="line">    Cno <span class="type">CHAR</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>，</span><br><span class="line">    Grade <span class="type">SMALLINT</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(Sno,Cno)，</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (Sno) <span class="keyword">REFERENCES</span> Student(Sno)</span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="comment">/*级联删除SC表中相应的元组*/</span></span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE, <span class="comment">/*级联更新SC表中相应的元组*/</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (Cno) <span class="keyword">REFERENCES</span> Course(Cno)</span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">NO</span> ACTION </span><br><span class="line">    <span class="comment">/*当删除course 表中的元组造成了与SC表不一致时拒绝删除*/</span></span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE </span><br><span class="line">    <span class="comment">/*当更新course表中的cno时，级联更新SC表中相应的元组*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="用户定义的完整性-2"><a class="markdownIt-Anchor" href="#用户定义的完整性-2">#</a> 用户定义的完整性</h2>
<p>提供定义和检验这类完整性的机制</p>
<p>不允许取空值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC</span><br><span class="line">( </span><br><span class="line">     Sno <span class="type">CHAR</span>(<span class="number">9</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">     Cno <span class="type">CHAR</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">     Grade <span class="type">SMALLINT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">     <span class="keyword">PRIMARY</span> KEY (Sno, Cno), </span><br><span class="line"> …</span><br><span class="line"><span class="comment">/*如果在表级定义实体完整性，隐含了Sno，Cno不允许取空值，则在列级不允许取空值的定义可以不写*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>列值唯一：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DEPT </span><br><span class="line">( </span><br><span class="line">    Deptno <span class="type">NUMERIC</span>(<span class="number">2</span>),</span><br><span class="line">    Dname <span class="type">CHAR</span>(<span class="number">9</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>，</span><br><span class="line">    Location <span class="type">CHAR</span>(<span class="number">10</span>), <span class="keyword">PRIMARY</span> KEY (Deptno) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>用 CHECK 短语指定列值应该满足的条件：</p>
<p>当学生的性别是男时，其名字不能以 Ms. 打头</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">( </span><br><span class="line">    Sno <span class="type">CHAR</span>(<span class="number">9</span>), </span><br><span class="line">    Sname <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>，</span><br><span class="line">    Ssex <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    Sage <span class="type">SMALLINT</span>,</span><br><span class="line">    Sdept <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (Sno),</span><br><span class="line">    <span class="keyword">CHECK</span> (Ssex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span> <span class="keyword">OR</span> Sname <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;Ms.%&#x27;</span>)</span><br><span class="line">    <span class="comment">/*定义了元组中Sname和 Ssex两个属性值之间的约束条件*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="完整性约束命名"><a class="markdownIt-Anchor" href="#完整性约束命名">#</a> 完整性约束命名</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span>完整性约束条件名<span class="operator">&gt;</span><span class="operator">&lt;</span>完整性约束条件<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>&lt;完整性约束条件&gt; 包括 NOT NULL、UNIQUE、PRIMARY KEY 短语、FOREIGN KEY 短语、CHECK 短语等</p>
<p>实例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">( </span><br><span class="line">    Sno <span class="type">NUMERIC</span>(<span class="number">6</span>)</span><br><span class="line">    	<span class="keyword">CONSTRAINT</span> C1 <span class="keyword">CHECK</span> (Sno <span class="keyword">BETWEEN</span> <span class="number">90000</span> <span class="keyword">AND</span> <span class="number">99999</span>),</span><br><span class="line">    Sname <span class="type">CHAR</span>(<span class="number">20</span>)</span><br><span class="line">   		<span class="keyword">CONSTRAINT</span> C2 <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    Sage <span class="type">NUMERIC</span>(<span class="number">3</span>)</span><br><span class="line">    	<span class="keyword">CONSTRAINT</span> C3 <span class="keyword">CHECK</span> (Sage <span class="operator">&lt;</span> <span class="number">30</span>),</span><br><span class="line">    Ssex <span class="type">CHAR</span>(<span class="number">2</span>)</span><br><span class="line">    	<span class="keyword">CONSTRAINT</span> C4 <span class="keyword">CHECK</span> (Ssex <span class="keyword">IN</span> ( ‘男’,<span class="string">&#x27;女&#x27;</span>)),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> StudentKey <span class="keyword">PRIMARY</span> KEY(Sno)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>修改完整性限制：</p>
<p>先 DROP 再 ADD：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Student </span><br><span class="line">	<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> C1;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">	<span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> C1 <span class="keyword">CHECK</span> (Sno <span class="keyword">BETWEEN</span> <span class="number">900000</span> <span class="keyword">AND</span> <span class="number">999999</span>);</span><br></pre></td></tr></table></figure>
<h2 id="断言"><a class="markdownIt-Anchor" href="#断言">#</a> 断言</h2>
<p>任何使断言不为真值的操作都会被拒绝执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ASSERTION<span class="operator">&lt;</span>断言名<span class="operator">&gt;</span><span class="operator">&lt;</span><span class="keyword">CHECK</span> 子句<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>实例： 限制数据库课程最多 60 名学生选修</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ASSERTION ASSE_SC_DB_NUM </span><br><span class="line"><span class="keyword">CHECK</span> (<span class="number">60</span> <span class="operator">&gt;=</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="comment">/*此断言的谓词涉及聚集操作count的SQL语句*/</span></span><br><span class="line">	<span class="keyword">From</span> Course,SC</span><br><span class="line">	<span class="keyword">Where</span> SC.Cno<span class="operator">=</span>Course.Cno <span class="keyword">and</span> Course.Cname <span class="operator">=</span><span class="string">&#x27;数据库&#x27;</span>) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>修改断言：</p>
<p>限制每个学期每一门课程最多 60 名学生选修</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> SC </span><br><span class="line"><span class="keyword">ADD</span> TERM <span class="type">DATE</span>; <span class="comment">-- 首先需要修改SC表，增加一个“TERM”属性，类型为DATE</span></span><br><span class="line"><span class="keyword">CREATE</span> ASSERTION ASSE_SC_CNUM2</span><br><span class="line"><span class="keyword">CHECK</span>(<span class="number">60</span> <span class="operator">&gt;=</span> <span class="keyword">ALL</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) </span><br><span class="line">    <span class="keyword">FROM</span> SC</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">by</span> cno,TERM)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="触发器"><a class="markdownIt-Anchor" href="#触发器">#</a> 触发器</h2>
<ol>
<li>
<p>触发器保存在<strong>数据库服务器</strong>中</p>
</li>
<li>
<p>任何用户对表的增、删、改操作均由服务器<strong>自动</strong>激活相应的触发器</p>
</li>
<li>
<p>触发器可以实施更为复杂的检查和操作，具有更精细和更强大的数据控制能力</p>
</li>
<li>
<p><strong>表</strong>的<strong>拥有者</strong>才可以在表上<strong>创建</strong>触发器</p>
</li>
<li>
<p>触发器<strong>只</strong>能定义在<strong>基本表</strong>上，不能定义在视图</p>
</li>
</ol>
<p>定义：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> <span class="operator">&lt;</span>触发器名<span class="operator">&gt;</span> </span><br><span class="line">&#123;BEFORE <span class="operator">|</span> AFTER&#125; <span class="operator">&lt;</span>触发事件<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">REFERENCING</span> <span class="keyword">NEW</span><span class="operator">|</span><span class="keyword">OLD</span> <span class="type">ROW</span> <span class="keyword">AS</span><span class="operator">&lt;</span>变量<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> &#123;<span class="type">ROW</span> <span class="operator">|</span> STATEMENT&#125;</span><br><span class="line">[<span class="keyword">WHEN</span> <span class="operator">&lt;</span>触发条件<span class="operator">&gt;</span>]<span class="operator">&lt;</span>触发动作体<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>详细说明：</p>
<ol>
<li>
<p><code>FOR EACH ROW</code>  是行级触发器， <code>FOR EACH STATEMENT</code>  是语句级触发器</p>
<p>eg：假设表 TEACHER 有 1000 行，在表上创建了一个触发器，触发事件是 <code>UPDATE TEACHER SET Deptno=5;</code></p>
<ul>
<li>如果是<strong>语句</strong>级触发器，那么执行完 UPDATE 后触发动作执行<strong>一次</strong></li>
<li>如果是<strong>行级</strong>触发器，触发动作执行<strong> 1000</strong> 次</li>
</ul>
</li>
<li>
<p>如果省略 WHEN 触发条件，则触发动作体在触发器激活后立即执行</p>
</li>
<li>
<p>如果是<strong>行级</strong>触发器，用户都可以在过程体中使用 NEW 和 OLD 引用事件之后的新值和事件之前的旧值；如果是<strong>语句</strong>级触发器，则不能使用 NEW 或 OLD 进行引用</p>
</li>
</ol>
<p>实例 1：当对表 SC 的 Grade 属性进行修改时，若分数增加了 10% 则将此次操作记录到下面表中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>C</mi><mi>U</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>C</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>O</mi><mi>l</mi><mi>d</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mo separator="true">,</mo><mi>N</mi><mi>e</mi><mi>w</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">SC_U(Sno,Cno,Oldgrade,Newgrade)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span>，其中 Oldgrade 是修改前的分数，Newgrade 是修改后的分数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> SC_T</span><br><span class="line">AFTER <span class="keyword">UPDATE</span> <span class="keyword">OF</span> Grade <span class="keyword">ON</span> SC</span><br><span class="line"><span class="keyword">REFERENCING</span> <span class="keyword">OLD</span> <span class="type">row</span> <span class="keyword">AS</span> OldTuple, <span class="keyword">NEW</span> <span class="type">row</span> <span class="keyword">AS</span> NewTuple</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> </span><br><span class="line"><span class="keyword">WHEN</span> (NewTuple.Grade <span class="operator">&gt;=</span> <span class="number">1.1</span> <span class="operator">*</span> OldTuple.Grade)</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SC_U(Sno,Cno,OldGrade,NewGrade)</span><br><span class="line"><span class="keyword">VALUES</span>(OldTuple.Sno,OldTuple.Cno,OldTuple.Grade,NewTuple.Grade)</span><br></pre></td></tr></table></figure>
<p>实例 2：将每次对表 Student 的插入操作所增加的学生个数记录到表 StudentInsertLog 中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> Student_Count</span><br><span class="line">AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> Student </span><br><span class="line"><span class="comment">/*指明触发器激活的时间是在执行INSERT后*/</span> </span><br><span class="line"><span class="keyword">REFERENCING</span> <span class="keyword">NEW</span> <span class="keyword">TABLE</span> <span class="keyword">AS</span> DELTA</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> STATEMENT </span><br><span class="line"><span class="comment">/*语句级触发器, 即执行完INSERT语句后下面的触发动作体才执行一次*/</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> StudentInsertLog (Numbers)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> DELTA</span><br></pre></td></tr></table></figure>
<p>删除触发器：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> <span class="operator">&lt;</span>触发器名<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="delimiter"><a class="markdownIt-Anchor" href="#delimiter">#</a> delimiter</h2>
<p>默认情况下，delimiter 是分号 “;”。在命令行客户端中，如果有一行命令以分号结束，那么回车后 mysql 将会执行该</p>
<p>命令。但有时候，不希望 MySQL 这么做。因为可能输入较多的语句，且语句中包含有分号。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> s_t.SC_trigger ;</span><br><span class="line">delimiter <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> SC_trigger after <span class="keyword">update</span> <span class="keyword">on</span> sc <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">    if </span><br><span class="line">    	new.grade <span class="operator">&gt;=</span> <span class="number">95</span> <span class="keyword">then</span> </span><br><span class="line">    	<span class="keyword">update</span> student <span class="keyword">set</span> scholarship<span class="operator">=</span><span class="string">&#x27;是’ </span></span><br><span class="line"><span class="string">   		where (scholarship=&#x27;</span>否<span class="string">&#x27;) AND (student.sno=new.sno) ;</span></span><br><span class="line"><span class="string">    end if;</span></span><br><span class="line"><span class="string">end;//</span></span><br></pre></td></tr></table></figure>
<h1 id="关系数据库理论"><a class="markdownIt-Anchor" href="#关系数据库理论">#</a> 关系数据库理论</h1>
<p><strong>数据依赖</strong>：一个关系内部属性与属性之间的一种约束关系，主要类型包括<strong>函数依赖 (FD)<strong> 和</strong>多值依赖 (MVD)</strong>。</p>
<h2 id="函数依赖"><a class="markdownIt-Anchor" href="#函数依赖">#</a> 函数依赖</h2>
<p><strong>概念</strong>：设关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>，U 是属性集，令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X,Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 是 U 的两个子集，对于任意 R 的一个关系 r，X 的每一个具体值，Y 都有唯一值与之对应<br>
则称 X 决定函数 Y 或 Y 函数依赖于 X，记作 **<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>**（X 是自变量，Y 是因变量，一个 X 只能得到一个 Y）</p>
<p><strong>非平凡的函数依赖</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，但<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊄</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\not\subset X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></p>
<p><strong>平凡的函数依赖</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，但<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊂</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\subset X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>←</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\leftarrow \rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo separator="true">,</mo><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">X\to Y,Y\to X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\nrightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></strong>：Y 不依赖于函数 X</p>
<p><strong>完全函数依赖</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，且对于 X 的任何一个真子集 X’，都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X&#x27;\not\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，则称 Y 对 X 完全函数依赖，记作：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo><mover><mo><mo>⟶</mo></mo><mi>F</mi></mover></mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\stackrel{F}{\longrightarrow} Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3003310000000001em;vertical-align:-0.011em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2893310000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">⟶</span></span></span><span style="top:-3.7110000000000003em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></p>
<p><strong>部分函数依赖</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，但 Y 对 X 不完全函数依赖，则称 Y 对 X 部分函数依赖，记作：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo><mover><mo><mo>⟶</mo></mo><mi>P</mi></mover></mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\stackrel{P}{\longrightarrow} Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3003310000000001em;vertical-align:-0.011em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2893310000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">⟶</span></span></span><span style="top:-3.7110000000000003em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></p>
<p><strong>传递函数依赖</strong>：如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>⊄</mo><mi>X</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>Y</mi><mo>↛</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>→</mo><mi>Z</mi><mo stretchy="false">(</mo><mi>Z</mi><mo>⊄</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X\to Y(Y\not\subset X),Y\not\to X,Y\to Z(Z\not\subset Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 则称 Z 对 X 传递函数依赖</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mtext>注：</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{red}{注：}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord" style="color:red;"><span class="mord cjk_fallback" style="color:red;">注</span><span class="mord cjk_fallback" style="color:red;">：</span></span></span></span></span> 如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y→X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>, 即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>←</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X←→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，则 Z 直接依赖于 X，而不是传递函数依赖。</p>
<h3 id="码"><a class="markdownIt-Anchor" href="#码">#</a> 码</h3>
<blockquote>
<p>K 为属性或属性组合</p>
</blockquote>
<p><strong>超码</strong>：U 函数依赖于 K，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>→</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">K\to U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>，则称 K 是超码</p>
<p><strong>候选码</strong>：若 $K\stackrel {F}{\longrightarrow} $U，则 K 为 R 的候选码</p>
<p><strong>主码</strong>：若候选码多于一个，选定一个为主码</p>
<p><strong>主属性</strong>：包含在任何一个候选码中的属性</p>
<p><strong>非主属性 / 非码属性</strong>：不包含在任何一个候选码中的属性</p>
<p><strong>全码</strong>：整个属性组是码</p>
<p>eg： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>W</mi><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(P,W,A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span> ，P：演奏者 W：作品 A：听众。一个演奏者可以演奏多个作品，某一作品可被多个演奏者演奏，听众可以欣赏不同演奏者的不同作品，码为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>W</mi><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P,W,A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span> 为全码</p>
<p><strong>求候选码</strong>：将左部、右部出现的元素分别列出，划去同时出现在两边的属性，剩下的只出现的左部的一定是主属性；出现在右部的一定不是主属性。</p>
<h2 id="多值依赖"><a class="markdownIt-Anchor" href="#多值依赖">#</a> 多值依赖</h2>
<p><strong>概念</strong>：设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 是属性集 U 上的一个关系模式，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X,Y,Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 是 U 的子集，并且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mi>U</mi><mo>−</mo><mi>X</mi><mo>−</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Z=U-X-Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，关系模式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 中多值依赖<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 成立，当且仅当对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 的任一关系 r，给定的一对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> 值，有一组 Y 的值，<strong>这组值仅仅决定于 x 值而与 z 值无关</strong>。</p>
<p>eg：<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410162009688.jpg" alt=""></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>e</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>i</mi><mi>n</mi><mi>g</mi><mtext>（</mtext><mi>C</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>B</mi><mtext>）</mtext></mrow><annotation encoding="application/x-tex">Teaching（C, T, B）</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord cjk_fallback">（</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">）</span></span></span></span>对于 C 的每一个值，T 有一组值与之对应，而不论 B 取何值。因此 T 多值依赖于 C，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>→</mo><mo>→</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">C→→T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>。</p>
<p><strong>平凡的多值依赖</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，而<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">Z=\varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord amsrm">∅</span></span></span></span>，则称<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 为平凡的多值连接</p>
<h3 id="性质"><a class="markdownIt-Anchor" href="#性质">#</a> 性质</h3>
<p>** 对称性：** 若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mi>U</mi><mo>−</mo><mi>X</mi><mo>−</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Z=U-X-Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></p>
<p>** 传递性：** 若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y→→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Z</mi><mo>−</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Z-Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></p>
<p>函数依赖可以看做多值依赖的特殊情况。</p>
<p>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→→YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>。</p>
<p>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi><mo>∩</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→→Y\cap Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>。</p>
<p>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi><mo>−</mo><mi>Z</mi><mo separator="true">,</mo><mi>X</mi><mo>→</mo><mo>→</mo><mi>Z</mi><mo>−</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y-Z,X→→Z-Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>。</p>
<h2 id="函数依赖和多值依赖的比较"><a class="markdownIt-Anchor" href="#函数依赖和多值依赖的比较">#</a> 函数依赖和多值依赖的比较</h2>
<ol>
<li>
<p>多值依赖的有效性与属性集的范围有关。即若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 在 U 上成立，则在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo stretchy="false">(</mo><mi>X</mi><mi>Y</mi><mo>⊂</mo><mi>W</mi><mo>⊂</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W(XY\subset W\subset U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 上一定成立；反之则不然。因为多值依赖的定义中不仅涉及属性组 X 和 Y，而且涉及 U 中其余属性 Z</p>
</li>
<li>
<p>函数依赖<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 上成立，则对于任何<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⊂</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y&#x27;\subset Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 均有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">X→Y&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 成立</p>
<p>多值依赖<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 上成立，却不能断言对于任何<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⊂</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y&#x27;\subset Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 均有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">X→→Y&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 成立</p>
</li>
</ol>
<p>eg：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mo>→</mo><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">A\to \to BC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>，但是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\to \to B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 不成立</p>
<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410162140664.jpg" style="zoom: 33%;" />
<h2 id="范式"><a class="markdownIt-Anchor" href="#范式">#</a> 范式</h2>
<p>各范式之间的关系：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mi>N</mi><mi>F</mi><mo>⊂</mo><mn>4</mn><mi>N</mi><mi>F</mi><mo>⊂</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi><mo>⊂</mo><mn>3</mn><mi>N</mi><mi>F</mi><mo>⊂</mo><mn>2</mn><mi>N</mi><mi>F</mi><mo>⊂</mo><mn>1</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">5NF\subset 4NF\subset BCNF\subset 3NF\subset 2NF\subset 1NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">5</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></p>
<p><strong>规范化</strong>：一个低一级范式的关系模式，通过模式分解可以转换为若干个高一级范式的关系模式的集合。</p>
<p><strong>1NF</strong>：每个列属性都是不可分的数据项。</p>
<p>存在问题：数据冗余、更新异常、插入异常、删除异常</p>
<p><strong>2NF</strong>：若关系模式<em> R</em>∈1NF，并且每一个<strong>非主属性</strong>都<strong>完全</strong>函数依赖于任何一个<strong>候选码</strong>，则<em> R</em>∈2NF</p>
<p>单属性码的关系模式必然属于 2NF</p>
<p><strong>3NF</strong>：设关系模式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo><mo>∈</mo><mn>1</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;∈1NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, 若<em> R</em> 中<strong>不存在</strong>这样的<strong>码<em> X</em></strong>、属性组<em> Y</em> 及非主属性<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>Z</mi><mo>⊄</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z(Z \not\subset Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>, 使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mtext>，</mtext><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→Y，Y→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 成立，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>↛</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\not\to X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 不成立，则称<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo><mo>∈</mo><mn>3</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R&lt;U,F &gt; ∈ 3NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>。</p>
<p>双目的关系模式必属于 3NF。</p>
<p>eg：</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410162201299.png" alt=""></p>
<p><strong>BCNF</strong>：设关系模式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo><mo>∈</mo><mn>1</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R&lt;U,F &gt;∈1NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>，若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X→Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊄</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y \not\subset X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 时<strong><em> X</em> 必含有码</strong>，则<em> R</em>&lt;<em>U</em>,<em>F</em> &gt;∈BCNF。即如果每一个决定属性集（左部）都包含候选码，则 R∈BCNF。</p>
<ul>
<li>
<p>所有非主属性对每一个码都是完全函数依赖</p>
</li>
<li>
<p>所有主属性对每一个不包含它的码也是完全函数依赖</p>
</li>
<li>
<p>没有任何属性完全函数依赖于非码的任何一组属性</p>
</li>
<li>
<p>一个候选码，一定是 BCNF；全码一定是 BCNF。</p>
</li>
</ul>
<p>如果一个关系数据库中的所有关系模式都属于 BCNF，那么<strong>在函数依赖</strong>范畴内，它已实现了模式的彻底分解，达到了最高的规范化程度，消除了插入异常和删除异常。</p>
<p><strong>4NF</strong>：关系模式<em> R</em>&lt;<em>U</em>,<em>F</em> &gt;∈1NF，如果对于<em> R</em> 的每个非平凡多值依赖<em> X</em>→→<em>Y</em>（<em>Y</em> ⊈ <em>X</em>），<em>X</em> 都含有码，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi>U</mi><mo separator="true">,</mo><mi>F</mi><mo>&gt;</mo><mo>∈</mo><mn>4</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R&lt;U,F&gt;∈4NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>。</p>
<p>限制关系模式的属性之间不允许有<strong>非平凡且非函数依赖</strong>的多值依赖。4NF 所允许的非平凡多值依赖实际上是函数依赖。</p>
<p><strong>5NF</strong>：如果关系模式 R 中的每一个连接依赖均由 R 的候选码所隐含，则称此关系模式符合第五范式</p>
<p><strong>判断方式</strong>：其中超键表示含有候选码的属性组合</p>
<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410162224855.png" style="zoom:67%;" />
<p><strong>规范化基本步骤</strong>：</p>
<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410162309213.png" alt="image-20241016230915160" style="zoom:67%;" />
<h1 id="数据库设计"><a class="markdownIt-Anchor" href="#数据库设计">#</a> 数据库设计</h1>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410171138720.png" alt=""></p>
<h2 id="需求分析"><a class="markdownIt-Anchor" href="#需求分析">#</a> 需求分析</h2>
<h3 id="数据字典"><a class="markdownIt-Anchor" href="#数据字典">#</a> 数据字典</h3>
<p><strong>数据项</strong>：数据项是不可再分的数据单位。</p>
<p 数据项名,数据项含义说明,别名,数据类型,长度,取值范围,取值含义,与其他数据项的逻辑关系,数据项之间的联系="">数据项描述 =</p>
<p><strong>数据结构</strong>：数据结构反映了数据之间的组合关系。</p>
<p>一个数据结构可以由若干个<strong>数据项</strong>组成，也可以由若干个<strong>数据结构</strong>组成，或由若干个数据项和数据结构<strong>混合</strong>组成。</p>
<p>数据结构描述 = {数据结构名，含义说明，组成:{数据项或数据结构}}</p>
<p><strong>数据流</strong>：数据流是数据结构在系统内传输的路径。</p>
<p>数据流描述 = {数据流名，说明，数据流来源，数据流去向，组成:{数据结构}, 平均流量，高峰期流量}</p>
<p><strong>数据存储</strong>：数据存储是数据结构停留或保存的地方，也是数据流的来源和去向之一。</p>
<p>数据存储描述 = {数据存储名，说明，编号，输入的数据流，输出的数据流，组成:{数据结构}, 数据量，存取频度，存取方式}</p>
<p><strong>处理过程</strong>：处理过程一般用判定表或判定树来描述。</p>
<p>处理过程描述 = {处理过程名，说明，输入:{数据流}, 输出:{数据流}, 处理:{简要说明}}</p>
<h2 id="概念结构设计"><a class="markdownIt-Anchor" href="#概念结构设计">#</a> 概念结构设计</h2>
<h3 id="e-r模型"><a class="markdownIt-Anchor" href="#e-r模型">#</a> E-R 模型</h3>
<p>E-R 图中所表示的联系是实体之间的联系。</p>
<p><strong>实体</strong>：用<strong>矩形</strong>表示，矩形框内写明实体名</p>
<p><strong>属性</strong>：用<strong>椭圆形</strong>表示，并用无向边将其与相应的实体型连接起来</p>
<p><strong>联系</strong>：用<strong>菱形</strong>表示，菱形框内写明联系名，并用无向边分别与有关实体型连接起来，同时在无向边旁标上联系的类型（1∶1，1∶<em>n</em> 或<em> m</em>∶<em>n</em>）</p>
<p>实例：某个工厂物资管理的概念模型</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410171138208.png" alt=""></p>
<p><strong>E-R 图的集成</strong></p>
<ul>
<li>
<p>合并：解决各分 E-R 图之间的冲突，将分 E-R 图合并起来生成初步 E-R 图。</p>
<p>冲突主要包括：属性冲突、命名冲突、结构冲突</p>
</li>
<li>
<p>修改和重构。消除不必要的冗余，生成基本 E-R 图。</p>
</li>
</ul>
<p><strong>优化</strong></p>
<p>对关系模式进行必要分解，提高数据操作效率和存储空间的利用率。</p>
<h2 id="逻辑结构设计"><a class="markdownIt-Anchor" href="#逻辑结构设计">#</a> 逻辑结构设计</h2>
<p>把概念结构设计阶段设计好的基本 E-R 图<strong>转换</strong>为与选用数据库管理系统产品所支持的数据模型相符合的逻辑结构</p>
<h2 id="物理结构设计"><a class="markdownIt-Anchor" href="#物理结构设计">#</a> 物理结构设计</h2>
<p>数据库在物理设备上的<strong>存储结构</strong>与<strong>存取方法</strong>称为数据库的物理结构，它依赖于选定的数据库管理系统。</p>
<p>数据库管理系统常用存取方法</p>
<ol>
<li>
<p>B + 树索引存取方法</p>
</li>
<li>
<p>Hash 索引存取方法</p>
</li>
<li>
<p>聚簇存取方法</p>
</li>
</ol>
<p><strong>聚簇</strong>：为了提高某个属性（或属性组）的查询速度，把这个或这些属性（称为聚簇码）上具有相同值的元组集中存放在连续的物理块中称为聚簇。</p>
<p><strong>聚簇索引</strong>：在一个基本表上最多只能建立一个聚簇索引</p>
<p>聚簇索引的<strong>适用条件</strong>：</p>
<ul>
<li>
<p>很少对基表进行增删操作</p>
</li>
<li>
<p>很少对其中的变长列进行 修改操作</p>
</li>
</ul>
<h2 id="数据库实施-运行和维护"><a class="markdownIt-Anchor" href="#数据库实施-运行和维护">#</a> 数据库实施、运行和维护</h2>
<h1 id="数据库编程"><a class="markdownIt-Anchor" href="#数据库编程">#</a> 数据库编程</h1>
<h2 id="嵌入式sql"><a class="markdownIt-Anchor" href="#嵌入式sql">#</a> 嵌入式 SQL</h2>
<p>为了区分 SQL 语句与主语言语句，所有 SQL 语句必须加前缀 <code>EXEC SQL</code> ，C 语句格式：  <code>EXEC SQL &lt;SQL语句&gt;;</code></p>
<h3 id="与主语言之间的通信"><a class="markdownIt-Anchor" href="#与主语言之间的通信">#</a> 与主语言之间的通信</h3>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410171620681.png" alt=""></p>
<p><strong>SQL 通信区</strong>：系统给应用程序若干信息，主要包括系统当前工作状态和运行环境的各种数据。</p>
<p>使用 <code>EXEC SQL INCLUDE SQLCA</code>  定义通信区</p>
<p>通信区的变量 <code>SQLCODE</code>  存放每次执行 SQL 语句后返回的代码；每执行完一条 SQL 语句都应该测试一下 SQLCODE 的值</p>
<p><strong>主变量</strong>：嵌入式 SQL 语句中可以使用<strong>主语言的程序变量</strong>来输入或输出数据</p>
<p>在 SQL 语句中使用主变量时，为了与数据库对象名（表名、视图名、列名等）区别，SQL 语句中的<strong>主变量名前</strong>要 ** 加冒号（:）** 作为标志</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 主变量和指示变量在中间定义</span></span><br><span class="line"><span class="keyword">BEGIN</span> <span class="keyword">DECLARE</span> SECTION</span><br><span class="line">……</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">DECLARE</span> SECTION</span><br></pre></td></tr></table></figure>
<p><strong>游标</strong>：为用户开设的一个数据缓冲区</p>
<p>每个游标区都有一个名字，用户可以通过游标逐一获取记录并赋给主变量，交由主语言进一步处理。</p>
<p><strong>建立和关闭数据库连接</strong>：</p>
<p><strong>建立</strong>数据库连接： <code>EXEC SQL CONNECT TO target[AS connection-name][USER user-name]; </code></p>
<p>target 是要连接的数据库服务器</p>
<p>常见的服务器标识串，如 <code>&lt;dbname&gt;@&lt;hostname&gt;:&lt;port&gt;</code></p>
<p><strong>关闭</strong>数据库连接 ：  <code>EXEC SQL DISCONNECT [connection];</code></p>
<p>实例：</p>
<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410171650317.jpg" style="zoom:67%;" />
<img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410171650713.jpg" style="zoom:67%;" />
<h3 id="不使用游标的sql语句"><a class="markdownIt-Anchor" href="#不使用游标的sql语句">#</a> 不使用游标的 SQL 语句</h3>
<p><strong>查询结果为单记录的 SELECT 语句：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">SELECT</span> Sno,Sname,Ssex,Sage,Sdept</span><br><span class="line"><span class="keyword">INTO</span>:Hsno,:Hname,:Hsex,:Hage,:Hdept</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sno<span class="operator">=</span>:givensno; <span class="comment">/*使用主变量givensno的值进行查询*/</span></span><br></pre></td></tr></table></figure>
<p><strong>非 CURRENT 形式的增删改语句：</strong></p>
<p>在 UPDATE 的 SET 字句和 WHERE 子句中可以使用主变量，SET 子句还可以使用指示变量</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gradeid<span class="operator">=</span><span class="number">-1</span>； <span class="comment">/*gradeid为指示变量，赋为负值*/</span></span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> SC(Sno,Cno,Grade)</span><br><span class="line"><span class="keyword">VALUES</span>(:stdno,:couno,:gr :gradeid)； <span class="comment">/*:stdno,:couno,:gr为主变量*/</span></span><br><span class="line"><span class="comment">-- 由于该学生刚选修课程，成绩应为空，所以要把指示变量赋为负值</span></span><br></pre></td></tr></table></figure>
<p><strong>指示变量</strong>：是一个整型变量，用来 “指示” 所指主变量的值或条件</p>
<ol>
<li>
<p>一个主变量可以附带一个指示变量指示变量的用途，指示输入主变量是否为空值</p>
</li>
<li>
<p>检测输出变量是否为空值，值是否被截断</p>
</li>
</ol>
<h3 id="使用游标的sql语句"><a class="markdownIt-Anchor" href="#使用游标的sql语句">#</a> 使用游标的 SQL 语句</h3>
<p><strong>查询结果为多条记录的 SELECT 语句</strong></p>
<p><strong>游标的使用</strong></p>
<p>说明游标 ： <code>EXEC SQL DECLARE &lt;游标名&gt; CURSOR FOR &lt;SELECT语句&gt;;</code></p>
<p>打开游标： <code>EXEC SQL OPEN &lt;游标名&gt;;</code></p>
<p>推进游标指针并取当前记录： <code>EXEC SQL FETCH &lt;游标名&gt; INTO &lt;主变量&gt;[&lt;指示变量&gt;][,&lt;主变量&gt;[&lt;指示变量&gt;]]...;</code></p>
<p>关闭游标：  <code>EXEC SQL CLOSE &lt;游标名&gt;;</code></p>
<p><strong>CURRENT 形式的 UPDATE 和 DELETE 语句</strong></p>
<p>因为 UPDATE 和 DELETE 语句都是集合操作，如果只想修改或删除其中的<strong>某个数据</strong>，则需要用带游标的 SELECT 语句查出所有满足条件的记录，从中进一步找出要修改或删除的记录，然后用 CURRENT 形式的 UPDATE 和 DELETE 语句修改或删除之。即 UPDATE 语句和 DELETE 语句中要用子句： <code>WHERE CURRENT OF &lt;游标名&gt;</code></p>
<p><strong>不能</strong>使用 CURRENT 形式的 UPDATE 语句和 DELETE 语句：</p>
<ol>
<li>
<p>当游标定义中的 SELECT 语句带有 UNION 或 ORDER BY 子句</p>
</li>
<li>
<p>该 SELECT 语句相当于定义了一个不可更新的视图</p>
</li>
</ol>
<h3 id="动态sql"><a class="markdownIt-Anchor" href="#动态sql">#</a> 动态 SQL</h3>
<ul>
<li>
<p>允许在程序运行过程中临时 “组装” SQL 语句</p>
</li>
<li>
<p>支持动态组装 SQL 语句和动态参数两种形式</p>
</li>
</ul>
<p>eg：创建基本表 TEST</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">BEGIN</span> <span class="keyword">DECLARE</span> SECTION;</span><br><span class="line">	const <span class="type">char</span> <span class="operator">*</span>stmt<span class="operator">=</span>&quot;CREATE TABLE test(a int);&quot;; </span><br><span class="line">	<span class="comment">/*SQL语句主变量，内容是创建表的SQL语句*/</span></span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">END</span> <span class="keyword">DECLARE</span> SECTION;</span><br><span class="line">... </span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">EXECUTE</span> IMMEDIATE :stmt;</span><br><span class="line"><span class="comment">/*执行动态SQL语句*/</span></span><br></pre></td></tr></table></figure>
<p>向 TEST 中插入元组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">BEGIN</span> <span class="keyword">DECLARE</span> SECTION;</span><br><span class="line">	const <span class="type">char</span> <span class="operator">*</span>stmt <span class="operator">=</span> &quot;INSERT INTO test VALUES(?);&quot;;</span><br><span class="line">	<span class="comment">/*声明SQL主变量内容是INSERT语句 */</span></span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">END</span> <span class="keyword">DECLARE</span> SECTION;</span><br><span class="line">... </span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">PREPARE</span> mystmt <span class="keyword">FROM</span> :stmt; <span class="comment">/*准备语句*/</span></span><br><span class="line">... </span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">EXECUTE</span> mystmt <span class="keyword">USING</span> <span class="number">100</span>; <span class="comment">/*设定INSERT语句插入值100 */</span></span><br><span class="line"><span class="keyword">EXEC</span> <span class="keyword">SQL</span> <span class="keyword">EXECUTE</span> mystmt <span class="keyword">USING</span> <span class="number">200</span>; <span class="comment">/* 设定INSERT语句插入值200 */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>使用参数符号（?）表示该位置的数据在运行时设定</p>
</li>
<li>
<p>通过 PREPARE 语句准备主变量和 EXECUTE 绑定数据或主变量来完成</p>
</li>
</ul>
<h2 id="过程化sql"><a class="markdownIt-Anchor" href="#过程化sql">#</a> 过程化 SQL</h2>
<h2 id="变量和常量定义"><a class="markdownIt-Anchor" href="#变量和常量定义">#</a> 变量和常量定义</h2>
<h3 id="变量"><a class="markdownIt-Anchor" href="#变量">#</a> 变量</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">变量名 数据类型 [[<span class="keyword">NOT</span> <span class="keyword">NULL</span>]:<span class="operator">=</span> 初值表达式]</span><br><span class="line">变量名 数据类型 [[<span class="keyword">NOT</span> <span class="keyword">NULL</span>] 初值表达式]</span><br></pre></td></tr></table></figure>
<h3 id="常量"><a class="markdownIt-Anchor" href="#常量">#</a> 常量</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">常量名 数据类型 CONSTANT:<span class="operator">=</span> 常量表达式</span><br></pre></td></tr></table></figure>
<h2 id="流程控制"><a class="markdownIt-Anchor" href="#流程控制">#</a> 流程控制</h2>
<h3 id="条件控制"><a class="markdownIt-Anchor" href="#条件控制">#</a> 条件控制</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IF <span class="keyword">condition</span> <span class="keyword">THEN</span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">ELSE</span> </span><br><span class="line">	...</span><br><span class="line"><span class="keyword">END</span> IF;</span><br></pre></td></tr></table></figure>
<h3 id="循环控制"><a class="markdownIt-Anchor" href="#循环控制">#</a> 循环控制</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--LOOP</span></span><br><span class="line">LOOP</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="comment">-- WHILE-LOOP</span></span><br><span class="line">WHILE <span class="keyword">condition</span> LOOP</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="comment">-- FOR-LOOP</span></span><br><span class="line"><span class="keyword">FOR</span> count <span class="keyword">IN</span>[REVERSE]bound1 ... bound2 LOOP</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="comment">-- 无REVERSE：count从bound1到bound2</span></span><br><span class="line"><span class="comment">-- 有REVERSE：count从bound2到bound1</span></span><br></pre></td></tr></table></figure>
<h2 id="存储过程"><a class="markdownIt-Anchor" href="#存储过程">#</a> 存储过程</h2>
<p>存储过程的<strong>优点</strong></p>
<p>1）运行效率高</p>
<p>2）降低了客户机和服务器之间的通信量</p>
<p>3）方便实施企业规则</p>
<p>存储过程的用户接口</p>
<p>1）创建存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> 过程名([参数<span class="number">1</span>，参数<span class="number">2</span>，...])</span><br><span class="line"><span class="keyword">AS</span> <span class="operator">&lt;</span>过程化<span class="keyword">SQL</span>块<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>2）执行存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span><span class="operator">/</span>PERFORM PROCEDURDE 过程名([参数<span class="number">1</span>，参数<span class="number">2</span>，...])</span><br></pre></td></tr></table></figure>
<p>3）修改存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span> 过程名<span class="number">1</span> RENAME <span class="keyword">TO</span> 过程名<span class="number">2</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span> 过程名 COMPILE</span><br></pre></td></tr></table></figure>
<p>4）删除存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> 过程名();</span><br></pre></td></tr></table></figure>
<h2 id="函数"><a class="markdownIt-Anchor" href="#函数">#</a> 函数</h2>
<p>1）定义</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">FUNCTION</span> 函数名([参数<span class="number">1</span>，参数<span class="number">2</span>，...]) <span class="keyword">RETURNS</span><span class="operator">&lt;</span>类型<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">AS</span> <span class="operator">&lt;</span>过程化<span class="keyword">SQL</span>块<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>2）执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span><span class="operator">/</span><span class="keyword">SELECT</span> 函数名([参数<span class="number">1</span>，参数<span class="number">2</span>，...])</span><br></pre></td></tr></table></figure>
<p>3）修改</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">FUNCTION</span> 过程名<span class="number">1</span> RENAME <span class="keyword">TO</span> 过程名<span class="number">2</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">FUNCTION</span> 函数名 COMPILE</span><br></pre></td></tr></table></figure>
<h2 id="odbc编程"><a class="markdownIt-Anchor" href="#odbc编程">#</a> ODBC 编程</h2>
<ol>
<li>用户应用程序</li>
<li>ODBC 驱动程序管理器</li>
<li>数据库驱动程序</li>
<li>ODBC 数据源管理</li>
</ol>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410211826961.png" alt=""></p>
<p><strong>ODBC 应用程序包括的内容</strong></p>
<ul>
<li>
<p>请求连接数据库</p>
</li>
<li>
<p>向数据源发送 SQL 语句</p>
</li>
<li>
<p>为 SQL 语句执行结果分配存储空间，定义所读取的数据格式</p>
</li>
<li>
<p>获取数据库操作结果或处理错误</p>
</li>
<li>
<p>进行数据处理并向用户提交处理结果</p>
</li>
<li>
<p>请求事务的提交和回滚操作</p>
</li>
<li>
<p>断开与数据源的连接</p>
</li>
</ul>
<p><strong>ODBC 应用程序不能直接存取数据库</strong></p>
<p>其各种操作请求由<strong>驱动</strong>提交给关系数据库管理系统的<strong> ODBC 驱动程序</strong>所支持的函数来存取数据库</p>
<p><strong>ODBC 3.0 标准提供了 76 个函数接口</strong></p>
<ul>
<li>
<p>分配和释放环境句柄、连接句柄、语句句柄 (32 位整数，指针)</p>
</li>
<li>
<p>连接函数（SQLDriverconnect 等）</p>
</li>
<li>
<p>与信息相关的函数（SQLGetinfo、SQLGetFuction 等）</p>
</li>
<li>
<p>事务处理函数（如 SQLEndTran）</p>
</li>
<li>
<p>执行相关函数（SQLExecdirect、SQLExecute 等）</p>
</li>
<li>
<p>编目函数，ODBC 3.0 提供了 11 个编目函数，如 SQLTables、SQLColumn 等。应用程序可以通过对编目函数的调用来获取数据字典的信息，如权限、表结构等</p>
</li>
</ul>
<p><strong>ODBC 数据源</strong></p>
<p>指定<strong>唯一</strong>的数据源名（Data Source Name，简称<strong> DSN</strong>），并映射到用户名、服务器名、所连接的数据库名等</p>
<p><strong>工作流程</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ret=<span class="built_in">SQLConnect</span>(kinghdbc,“KingbaseES ODBC”, SQL_NTS,“SYSTEM”, SQL_NTS, <span class="string">&quot;MANAGER&quot;</span>,SQL_NTS);<span class="comment">//配置数据源</span></span><br><span class="line">ret=<span class="built_in">SQLAllocHandle</span>(SQL_HANDLE_ENV,SQL_NULL_HANDLE,&amp;kinghenv);<span class="comment">//初始化环境</span></span><br><span class="line">ret=<span class="built_in">SQLConnect</span>(serverhdbc,<span class="string">&quot;SQLServer&quot;</span>, SQL_NTS, <span class="string">&quot;sa“,SQL_NTS, &quot;</span>sa<span class="string">&quot;,SQL_NTS);//建立连接</span></span><br><span class="line"><span class="string">ret=SQLAllocHandle(SQL_HANDLE_STMT,kinghdbc, &amp;kinghstmt);//分配语句句柄</span></span><br><span class="line"><span class="string">ret=SQLExecDirect(kinghstmt,&quot;</span>SELECT * FROM STUDENT<span class="string">&quot;,SQL_NTS);//执行SQL语句</span></span><br><span class="line"><span class="string">ret=SQLBindCol(kinghstmt,4,SQL_C_LONG,&amp;sAge,0,&amp;cbAge);</span></span><br><span class="line"><span class="string">while ((ret=SQLFetch(kinghstmt))!=SQL_NO_DATA_FOUND) //结果集处理</span></span><br><span class="line"><span class="string">&#123; </span></span><br><span class="line"><span class="string">	if(ret==SQL_ERROR) printf(&quot;</span>Fetch error\n<span class="string">&quot;);</span></span><br><span class="line"><span class="string">	else ret=SQLExecute(serverhstmt);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">SQLFreeHandle(SQL_HANDLE_STMT,kinghstmt);//中止处理</span></span><br><span class="line"><span class="string">SQLDisconnect(serverhdbc);</span></span><br></pre></td></tr></table></figure>
<h1 id="关系查询优化"><a class="markdownIt-Anchor" href="#关系查询优化">#</a> 关系查询优化</h1>
<p>查询的开销主要包括：磁盘存取块数（I/O 代价），处理机时间（CPU 代价）以及查询的内存开销</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410211851376.png" alt=""></p>
<h2 id="代数优化"><a class="markdownIt-Anchor" href="#代数优化">#</a> 代数优化</h2>
<blockquote>
<p>关系代数表达式的优化</p>
</blockquote>
<p><strong>选择操作</strong>的实现：</p>
<ol>
<li>全表扫描算法：对于规模较小的表或要查找的元组均匀地分布在查找的表中，该算法简单有效。</li>
<li>索引扫描算法：当选择率较低时，该算法效率更高。</li>
</ol>
<p><strong>连接操作</strong>的实现：</p>
<ol>
<li>嵌套循环算法</li>
<li>排序 - 合并算法</li>
<li>索引连接算法</li>
<li>hash join 算法</li>
</ol>
<p>典型的<strong>启发式规则</strong></p>
<p>1）<strong>选择</strong>运算应尽可能<strong>先</strong>做</p>
<p>2）把<strong>投影</strong>运算和<strong>选择</strong>运算同时进行</p>
<p>3）把投影同其前或其后的双目运算结合起来</p>
<p>4）等值连接运算要比同样关系上的笛卡尔积省很多时间</p>
<p>5）找出公共子表达式：构造中间结果文件，<strong>视图</strong>中构建公共表达式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 通过构建公共表达式 PriceCTE，避免了重复计算 TotalPrice，提高了查询效率。</span></span><br><span class="line"><span class="keyword">WITH</span> PriceCTE <span class="keyword">AS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> OrderID, ProductID, Quantity <span class="operator">*</span> UnitPrice <span class="keyword">AS</span> TotalPrice </span><br><span class="line">    <span class="keyword">FROM</span> OrderDetails</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> OrderID, TotalPrice <span class="keyword">FROM</span> PriceCTE <span class="keyword">WHERE</span> TotalPrice <span class="operator">&gt;</span> <span class="number">100</span>;</span><br><span class="line"><span class="keyword">SELECT</span> ProductID, TotalPrice <span class="keyword">FROM</span> PriceCTE <span class="keyword">WHERE</span> TotalPrice <span class="operator">&lt;</span> <span class="number">50</span>;</span><br></pre></td></tr></table></figure>
<p><strong>查询树</strong></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVgzNDExZDd0ZD9zcG1faWRfZnJvbT0zMzMuNzg4LnZpZGVvcG9kLnNlY3Rpb25zJmFtcDt2ZF9zb3VyY2U9ZWY1ZTUxMjc4MTk0NjBlMjYxODI5ODI5MzNjZmEyMWU=">Query tree &amp; Optimization｜查询树和优化查询树</span></p>
<ol>
<li>先将 SQL 语句转换成关系表达式，然后化成初始的查询树</li>
<li>将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span> 运算向下移</li>
<li>将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Π</mi></mrow><annotation encoding="application/x-tex">\Pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Π</span></span></span></span> 运算向下移</li>
</ol>
<h2 id="物理优化"><a class="markdownIt-Anchor" href="#物理优化">#</a> 物理优化</h2>
<blockquote>
<p>存取路径和底层操作算法的选择</p>
</blockquote>
<p>基于规则的启发式优化：启发式规则是指那些在大多数情况下都适用的规则。</p>
<p>基于代价估算的优化：优化器估算不同执行策略的代价，并选出最小代价的计划。</p>
<p>两者结合的优化方法：</p>
<ul>
<li>先使用启发式规则，选取若干较优的候选方案</li>
<li>然后分别计算这些候选方案的执行代价，选出最终的优化方案</li>
</ul>
<p><strong>选择操作</strong>的启发式规则</p>
<ol>
<li><strong>小</strong>关系：<strong>全表</strong>顺序扫描</li>
<li><strong>大</strong>关系：
<ul>
<li>选择条件是” 主码 = 值 “，查询结果最多是一个元组，利用主码<strong>索引</strong></li>
<li>选择条件是 “非主属性 = 值”/ 非等值查询或范围查询，查询结果<strong>比例较小</strong>利用<strong>索引</strong>扫描，否则利用全表扫描</li>
<li><strong>AND</strong> 连接的合取选择条件，有索引用索引，否则用全表顺序扫描</li>
<li><strong>OR</strong> 连接的析取选择条件，<strong>全表</strong>顺序扫描</li>
</ul>
</li>
</ol>
<p><strong>连接操作</strong>的启发式规则</p>
<ol>
<li>已按连接属性排序，选用排序 - 合并算法</li>
<li>连接属性上有索引，利用索引连接算法</li>
<li>一个表较小，使用 hash join 算法</li>
<li>嵌套循环算法，选择其中<strong>较小</strong>的表作为<strong>外表</strong></li>
</ol>
<p><strong>代价估算</strong></p>
<p><strong>全表扫描</strong>算法的代价估算公式</p>
<ul>
<li>
<p>如果基本表大小为 B 块，全表扫描算法的代价 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mtext>＝</mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">cost＝B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
</li>
<li>
<p>如果选择条件是 “码＝值”，那么平均搜索代价 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mtext>＝</mtext><mi>B</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">cost＝B/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/</span><span class="mord">2</span></span></span></span></p>
</li>
</ul>
<p><strong>索引扫描</strong>算法的代价估算公式</p>
<ul>
<li>
<p>如果选择条件是 “码＝值”，则采用该表的主索引</p>
<ul>
<li>若为 B + 树，层数为 L，需要存取 B + 树中从根结点到叶结点 L 块，再加上基本表中该元组所在的那一块，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mi>L</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">cost=L+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li>
</ul>
</li>
<li>
<p>如果选择条件涉及非码属性，若为 B + 树索引，选择条件是相等比较，S 是索引的选择基数 (有 S 个元组满足条件)</p>
<ul>
<li>满足条件的元组可能会保存在不同的块上，所以 (最坏的情况)<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mi>L</mi><mo>+</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">cost=L+S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></li>
</ul>
</li>
<li>
<p>如果比较条件是＞，＞＝，＜，＜＝，假设有一半的元组满足条件，就要通过索引访问一半的表存储块，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mi>L</mi><mo>+</mo><mi>Y</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo>+</mo><mi>B</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">cost=L+Y/2+B/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">/</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/</span><span class="mord">2</span></span></span></span></p>
</li>
</ul>
<p><strong>嵌套循环</strong>连接算法的代价估算公式</p>
<ul>
<li>
<p>嵌套循环连接算法的代价，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mtext>＝</mtext><mi>B</mi><mi>r</mi><mo>+</mo><mi>B</mi><mi>r</mi><mi>B</mi><mi>s</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cost＝Br+BrBs/(K-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">s</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
</li>
<li>
<p>连接结果写回磁盘，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mtext>＝</mtext><mi>B</mi><mi>r</mi><mo>+</mo><mi>B</mi><mi>r</mi><mi>B</mi><mi>s</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi>F</mi><mi>r</mi><mi>s</mi><mo>∗</mo><mi>N</mi><mi>r</mi><mo>∗</mo><mi>N</mi><mi>s</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>M</mi><mi>r</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cost＝Br+Br Bs/(K-1)+(Frs*Nr*Ns)/Mrs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">s</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span></span></span></span></p>
<ul>
<li>其中 Frs 为连接选择性，表示连接结果元组数的比例，Mrs 是存放连接结果的块因子，表示每块中可以存放的结果元组数目</li>
</ul>
</li>
</ul>
<p><strong>排序 - 合并</strong>连接算法的代价估算公式</p>
<ul>
<li>如果连接表已经按照连接属性排好序，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mtext>＝</mtext><mi>B</mi><mi>r</mi><mo>+</mo><mi>B</mi><mi>s</mi><mo>+</mo><mo stretchy="false">(</mo><mi>F</mi><mi>r</mi><mi>s</mi><mo>∗</mo><mi>N</mi><mi>r</mi><mo>∗</mo><mi>N</mi><mi>s</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>M</mi><mi>r</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cost＝Br+Bs+(Frs*Nr*Ns)/Mrs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span></span></span></span></li>
<li>如果必须对文件排序，还需要在代价函数中加上排序的代价
<ul>
<li>对于包含 B 个块的文件排序的代价大约是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo>∗</mo><mi>B</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>2</mn><mo>∗</mo><mi>B</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>2</mn><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2*B)+(2*B*log2B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
</ul>
<h1 id="数据库恢复"><a class="markdownIt-Anchor" href="#数据库恢复">#</a> 数据库恢复</h1>
<h2 id="事务"><a class="markdownIt-Anchor" href="#事务">#</a> 事务</h2>
<h3 id="定义-3"><a class="markdownIt-Anchor" href="#定义-3">#</a> 定义</h3>
<p><strong>事务</strong>是用户定义的一个数据库操作序列，这些操作要么全做，要么全不做，是<strong>不可分割</strong>的工作单位。</p>
<p>在关系数据库中，一个事务可以是<strong>一条</strong> SQL 语句，<strong>一组</strong> SQL 语句或整个程序，一个程序通常包含<strong>多个</strong>事务</p>
<p>事务是<strong>恢复</strong>和<strong>并发控制</strong>的基本单位</p>
<p><strong>定义</strong>事务的语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> TRANSACTION;<span class="comment">-- 开始</span></span><br><span class="line"><span class="keyword">COMMIT</span>;<span class="comment">-- 提交，将事务中所有对数据库的更新写回到磁盘上的物理数据库中</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>; <span class="comment">-- 回滚，运行中发生了某种故障，系统将事务中对数据库的所有已完成的操作全部撤销，回滚到事务开始的状态</span></span><br></pre></td></tr></table></figure>
<h3 id="acid特性"><a class="markdownIt-Anchor" href="#acid特性">#</a> ACID 特性</h3>
<p><strong>原子性 (Atomicity)</strong>：</p>
<p>事务中包括的诸操作要么都做，要么都不做</p>
<p><strong>一致性 (Consistency)</strong>：</p>
<p>事务执行的结果必须是使数据库从一个<strong>一致性</strong>状态变到另一个<strong>一致性</strong>状态。数据库中只包含成功事务提交的结果</p>
<p><strong>隔离性 (Isolation)</strong> ：</p>
<p>并发执行的各个事务之间不能互相干扰</p>
<p><strong>持续性 (Durability)</strong>：</p>
<p>一个事务一旦提交，它对数据库中数据的改变就应该是永久性的</p>
<h2 id="故障"><a class="markdownIt-Anchor" href="#故障">#</a> 故障</h2>
<h3 id="事务内部的故障"><a class="markdownIt-Anchor" href="#事务内部的故障">#</a> 事务内部的故障</h3>
<ul>
<li>
<p>软故障</p>
</li>
<li>
<p>事务没有达到预期的终点 (COMMIT 或者显式的 ROLLBACK)</p>
</li>
<li>
<p>事务撤消（UNDO）：强行回滚（ROLLBACK）该事务</p>
</li>
</ul>
<h3 id="系统故障"><a class="markdownIt-Anchor" href="#系统故障">#</a> 系统故障</h3>
<blockquote>
<p>是指造成系统停止运转的任何事件，使得系统要重新启动</p>
</blockquote>
<ul>
<li>
<p>软故障</p>
</li>
<li>
<p>系统重新启动时，恢复程序让所有非正常终止的事务回滚，强行<strong>撤消</strong>（UNDO）所有<strong>未完成事务</strong></p>
</li>
<li>
<p>恢复策略：系统重新启动时，恢复程序需要<strong>重做</strong>（REDO）所有<strong>已提交</strong>的事务</p>
</li>
</ul>
<h3 id="介质故障"><a class="markdownIt-Anchor" href="#介质故障">#</a> 介质故障</h3>
<ul>
<li>硬故障：外存故障。破坏数据库或部分数据库，并影响正在存取这部分数据的所有事务。</li>
</ul>
<h3 id="计算机病毒"><a class="markdownIt-Anchor" href="#计算机病毒">#</a> 计算机病毒</h3>
<h2 id="恢复实现技术"><a class="markdownIt-Anchor" href="#恢复实现技术">#</a> 恢复实现技术</h2>
<p>建立冗余数据最常用的技术是<strong>数据转储</strong>和<strong>登记日志文件</strong></p>
<h3 id="数据转储"><a class="markdownIt-Anchor" href="#数据转储">#</a> 数据转储</h3>
<p><strong>转储</strong>是指数据库管理员定期地将整个数据库<strong>复制</strong>到存储介质上保存起来的过程，备用的数据称为<strong>后备副本</strong> (backup)</p>
<p>将后备副本重新装入，将数据库<strong>恢复到转储时</strong>的状态；然后<strong>重新运行</strong>自转储<strong>以后</strong>的所有<strong>成功</strong>的事务</p>
<p><strong>静态转储</strong></p>
<ul>
<li>
<p>在系统中无运行事务时进行的转储操作</p>
</li>
<li>
<p>转储开始时数据库处于一致性状态</p>
</li>
<li>
<p>转储期间不允许对数据库的任何存取、修改活动</p>
</li>
<li>
<p>得到的一定是一个数据一致性的副本</p>
</li>
<li>
<p>优点：实现简单</p>
</li>
<li>
<p>缺点：降低了数据库的可用性</p>
<ul>
<li>转储必须等待正运行的用户事务结束</li>
<li>新的事务必须等转储结束</li>
</ul>
</li>
</ul>
<p><strong>动态转储</strong></p>
<ul>
<li>
<p>转储操作与用户事务并发进行</p>
</li>
<li>
<p>转储期间允许对数据库进行存取或修改</p>
</li>
<li>
<p>优点</p>
<ul>
<li>不用等待正在运行的用户事务结束</li>
<li>不会影响新事务的运行</li>
</ul>
</li>
<li>
<p>动态转储的缺点</p>
<ul>
<li>不能保证副本中的数据正确有效</li>
<li>例：在转储期间的某时刻<em> T</em>c，系统把数据 A=100 转储到磁带上，而在下一时刻<em> T</em>d，某一事务将 A 改为 200。后备副本上的 A 过时了</li>
</ul>
</li>
<li>
<p>把动态转储<strong>期间</strong>各事务对数据库的修改活动<strong>记录到日志文件</strong>，<strong>后备副本加上日志文件</strong>就能把数据库恢复到某一时刻的正确状态</p>
</li>
</ul>
<p><strong>海量转储</strong>：每次转储全部数据库</p>
<p><strong>增量转储</strong>：只转储上次转储后更新过的数据</p>
<h3 id="日志文件"><a class="markdownIt-Anchor" href="#日志文件">#</a> 日志文件</h3>
<p><strong>日志的格式和内容：</strong></p>
<p>以<strong>记录</strong>为单位的日志文件</p>
<ul>
<li>
<p>事务标识（标明是哪个事务）</p>
</li>
<li>
<p>操作类型（插入、删除或修改）</p>
</li>
<li>
<p>操作对象（记录 ID、Block NO.）</p>
</li>
<li>
<p>更新前数据的旧值（对插入操作而言，此项为空值）</p>
</li>
<li>
<p>更新后数据的新值（对删除操作而言，此项为空值）</p>
</li>
</ul>
<p>以<strong>数据块</strong>为单位的日志文件</p>
<ul>
<li>
<p>事务标识</p>
</li>
<li>
<p>被更新的数据块</p>
</li>
</ul>
<p><strong>日志的作用：</strong></p>
<ul>
<li>
<p>用来记录事务对数据库的<strong>更新</strong>操作的文件</p>
</li>
<li>
<p>进行事务故障恢复</p>
</li>
<li>
<p>进行系统故障恢复</p>
</li>
<li>
<p>协助后备副本进行介质故障恢复，不必重新运行那些已完成的事务</p>
</li>
</ul>
<p><strong>登记日志文件：</strong></p>
<ul>
<li>
<p>记录的次序严格按并发事务执行的时间次序</p>
</li>
<li>
<p>必须<strong>先</strong>写<strong>日志文件</strong>，后写数据库</p>
<ul>
<li>写日志文件操作：把本次修改的记录到日志文件中</li>
<li>写数据库操作：把对数据的修改写到数据库中</li>
</ul>
</li>
</ul>
<h2 id="恢复策略"><a class="markdownIt-Anchor" href="#恢复策略">#</a> 恢复策略</h2>
<h3 id="事务故障的恢复"><a class="markdownIt-Anchor" href="#事务故障的恢复">#</a> <strong>事务故障</strong>的恢复</h3>
<p>事务故障的恢复由<strong>系统自动完成</strong>，对用户是透明的</p>
<p>利用日志文件撤消（UNDO）此事务已对数据库进行的修改</p>
<ol>
<li>从日志最<strong>反向向前</strong>扫描日志文件，查找该事务的更新操作。</li>
<li>对该事务的更新操作执行<strong>逆</strong>操作。</li>
<li><strong>继续反向</strong>扫描日志文件，并做同样处理，<strong>直至</strong>读到此事务的<strong>开始标记</strong></li>
</ol>
<h3 id="系统故障的恢复"><a class="markdownIt-Anchor" href="#系统故障的恢复">#</a> <strong>系统故障</strong>的恢复</h3>
<p>由系统在<strong>重新启动时自动完成</strong>，不需要用户干预</p>
<p><strong>Undo</strong> 故障发生时<strong>未完成</strong>的事务；<strong>Redo 已完成</strong>的事务</p>
<ol>
<li><strong>正向</strong>扫描日志文件</li>
</ol>
<p>（<strong>都有</strong>）既有 BEGIN TRANSACTION 也有 COMMIT<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span><strong> 重做</strong> (REDO) <strong>队列</strong></p>
<p>（<strong>只有 BEGIN</strong>）只有 BEGIN TRANSACTION 无 COMMIT 记录<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span><strong> 撤销</strong> (UNDO)<strong> 队列</strong></p>
<ol start="2">
<li>
<p><strong>反向</strong>扫描日志文件，对 UNDO 队列<strong>事务</strong>进行<strong>撤销</strong>处理，执行逆操作，将 “更新前的值” 写入数据库</p>
</li>
<li>
<p><strong>正向</strong>扫描日志文件，对 REDO 队列<strong>事务</strong>进行<strong>重做</strong>处理，将 “更新后的值” 写入数据库</p>
</li>
</ol>
<h3 id="介质故障的恢复"><a class="markdownIt-Anchor" href="#介质故障的恢复">#</a> <strong>介质故障</strong>的恢复</h3>
<p><strong>重装</strong>数据库，<strong>重做已完成</strong>的事务</p>
<p>介质故障的恢复需要<strong>数据库管理员</strong>介入（数据库管理员只需要重装最近转储的数据库副本和有关的各日志文件副本，然后执行系统提供的恢复命令即可，具体操作仍由数据库管理系统完成）</p>
<ol>
<li>
<p><strong>装入</strong>最新的后备数据库<strong>副本</strong></p>
<ul>
<li>对于静态转储的数据库副本，装入后数据库即处于一致性状态</li>
<li>对于动态转储的数据库副本，还须利用<strong>恢复系统故障</strong>的方法恢复</li>
</ul>
</li>
<li>
<p>装入转储结束时刻的<strong>日志</strong>文件副本 ，<strong>重做已完成的事务</strong></p>
<ul>
<li>扫描日志文件，找出<strong>已提交</strong>的事务的标识，记入<strong>重做</strong>队列</li>
<li><strong>正向</strong>扫描日志文件，对重做队列中的所有事务进行重做处理。即将日志记录中 “更新后的值” 写入数据库</li>
</ul>
</li>
</ol>
<h3 id="具有检查点的恢复"><a class="markdownIt-Anchor" href="#具有检查点的恢复">#</a> 具有检查点的恢复</h3>
<ol>
<li>将当前日志缓冲区中的所有日志记录写入磁盘的日志文件上</li>
<li>在日志文件中写入一个检查点记录</li>
<li>将当前<strong>数据缓冲区</strong>的所有数据记录<strong>写入磁盘</strong>的数据库中</li>
<li>把检查点记录在<strong>日志文件</strong>中地址<strong>写入重新开始文件</strong></li>
</ol>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410271753282.png" alt=""></p>
<h2 id="镜像"><a class="markdownIt-Anchor" href="#镜像">#</a> 镜像</h2>
<p><strong>优点</strong></p>
<p>出现介质故障时</p>
<ul>
<li>
<p>可由镜像磁盘继续提供使用</p>
</li>
<li>
<p>同时数据库管理系统自动利用镜像磁盘数据进行数据库的恢复</p>
</li>
<li>
<p>不需要关闭系统和重装数据库副本</p>
</li>
</ul>
<p>可用于并发操作</p>
<ul>
<li>
<p>一个用户对数据加排他锁修改数据，其他用户可以读镜像数据库上的数据，而不必等待该用户释放锁频繁地复制数据自然会降低系统运行效率</p>
</li>
<li>
<p>在实际应用中用户往往只选择对关键数据和日志文件镜像</p>
</li>
</ul>
<h1 id="并发控制"><a class="markdownIt-Anchor" href="#并发控制">#</a> 并发控制</h1>
<h2 id="并发控制概述"><a class="markdownIt-Anchor" href="#并发控制概述">#</a> 并发控制概述</h2>
<p>多用户数据库系统：允许多个用户同时使用</p>
<p><strong>事务并发执行带来的问题：</strong></p>
<ul>
<li>
<p>会产生多个事务同时存取同一数据的情况</p>
</li>
<li>
<p>可能会破坏事务隔离性和数据库的一致性</p>
</li>
<li>
<p>数据库管理系统必须提供并发控制机制</p>
</li>
<li>
<p>并发控制机制是衡量数据库管理系统性能的重要标志</p>
</li>
</ul>
<p><strong>多事务执行方式</strong></p>
<ol>
<li>
<p>事务串行执行：</p>
<ul>
<li>
<p>每个时刻只有一个事务运行，其他事务必须等待</p>
</li>
<li>
<p>不能充分利用系统资源，发挥共享资源的特点</p>
</li>
</ul>
</li>
<li>
<p>交叉并发方式</p>
<ul>
<li>单处理机系统中，并行事务在轮流交叉运行</li>
<li>能够减少处理机的空闲时间</li>
</ul>
</li>
<li>
<p>同时并发方式</p>
<ul>
<li>多处理机系统中，可以同时运行多个并行事务</li>
<li>最理想的并发方式，但受制于硬件环境</li>
</ul>
</li>
</ol>
<p><strong>并发操作带来的数据不一致性</strong></p>
<p>1.<strong> 丢失修改</strong></p>
<p>两个事务 T1 和 T2 读入<strong>同一</strong>数据并修改，T2 的提交结果破坏了 T1 提交的结果，导致 T1 的修改被丢失</p>
<p>2.<strong> 不可重复读</strong></p>
<p>不可重复读是指事务 T1 读取数据后，事务 T2 执行更新操作，使 T1<strong> 无法再现</strong>前一次读取结果</p>
<p>3.<strong> 读 “脏” 数据</strong></p>
<p>事务 T1 修改某一数据，事务 T2 读取同一数据后，T1 由于某种原因<strong>撤销</strong>，T1 修改过的数据恢复原值，T2 读到的数据就为 “脏” 数据</p>
<h2 id="封锁"><a class="markdownIt-Anchor" href="#封锁">#</a> 封锁</h2>
<p>封锁就是，事务 T 在对某个数据对象 （例如表、记录等）<strong>操作之前</strong>，先向系统发出请求，对其<strong>加锁</strong></p>
<p>加锁后事务 T 就对该数据对象有了一定的控制，在事务 T 释放它的锁之前，其它的事务不能更新此数据对象</p>
<p><strong>排它锁（X 锁）</strong></p>
<p>若事务 T 对数据对象 A 加上 X 锁，则只允许 T 读取和修改 A，其它任何事务都不能再对 A 加任何类型的锁，直到 T 释放 A 上的锁</p>
<p>保证其他事务在 T 释放 A 上的锁之前<strong>不能再读取和修改</strong> A</p>
<p><strong>共享锁（S 锁）</strong></p>
<p>若事务 T 对数据对象 A 加上 S 锁，则事务 T<strong> 可以读</strong> A 但<strong>不能修改</strong> A，其它事务只能再对 A 加 S 锁，而不能加 X 锁，直到 T 释放 A 上的 S 锁</p>
<p>保证其他事务可以读 A，但在 T 释放 A 上的 S 锁之前<strong>不能</strong>对 A<strong> 做任何修改</strong></p>
<h3 id="封锁协议"><a class="markdownIt-Anchor" href="#封锁协议">#</a> 封锁协议</h3>
<p><strong>一级封锁协议</strong>：</p>
<p>一级封锁协议<strong>可防止丢失修改</strong>，并保证事务 T 是可恢复的。</p>
<p>事务 T 在修改数据 R 之前必须先对其加<strong> X 锁</strong>，直到事务结束才释放</p>
<p><strong>二级封锁协议</strong>：</p>
<p>一级封锁协议 + 事务 T 在读取数据 R 之前必须先对其加<strong> S 锁</strong>，<strong>读完</strong>后即可<strong>释放 S 锁</strong>。</p>
<p>二级封锁协议<strong>可以防止丢失修改和读 “脏” 数据</strong>，但是由于读完数据后即可释放 S 锁，所以它<strong>不能保证可重复读</strong>。</p>
<p><strong>三级封锁协议</strong></p>
<p>一级封锁协议 + 事务 T 在读取数据 R 之前必须先对其加<strong> S 锁</strong>，直到<strong>事务结束</strong>才释放。</p>
<p>三级封锁协议<strong>可防止丢失修改、读脏数据和不可重复读</strong>。</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410271753354.png" alt=""></p>
<h2 id="活锁和死锁"><a class="markdownIt-Anchor" href="#活锁和死锁">#</a> 活锁和死锁</h2>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410271753906.png" alt=""></p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202410271753801.png" alt=""></p>
<p>避免<strong>活锁</strong>：采用先来先服务的策略</p>
<p>预防<strong>死锁</strong>：破坏产生死锁的条件</p>
<ul>
<li>
<p><strong>一次</strong>封锁法：要求每个事务一次将要使用的数据全部加锁，否则不能继续执行</p>
</li>
<li>
<p><strong>顺序</strong>封锁法：预先对数据对象规定一个封锁顺序，都按这个顺序实行封锁</p>
</li>
</ul>
<h3 id="诊断并解除死锁"><a class="markdownIt-Anchor" href="#诊断并解除死锁">#</a> 诊断并解除死锁</h3>
<p><strong>超时法</strong>诊断死锁</p>
<p>如果一个事务的等待时间超过了时限，就认为死锁了</p>
<p>问题：有可能误判死锁时限若设置得太长，死锁发生后不能及时发现</p>
<p><strong>解除死锁</strong></p>
<p>选择一个处理死锁<strong>代价最小</strong>的事务，将其撤消</p>
<p>释放此事务持有的所有的锁，使其它事务能继续运行</p>
<h2 id="并发调度的可串行性"><a class="markdownIt-Anchor" href="#并发调度的可串行性">#</a> 并发调度的可串行性</h2>
<p>对并发事务不同的调度可能会产生不同的结果</p>
<p><strong>串行调度</strong>是正确的，执行结果等价于<strong>串行调度的调度</strong>也是正确的，称为<strong>可串行化调度</strong></p>
<p>当且仅当其结果与<strong>按某一次序串行地执行</strong>这些事务时的结果<strong>相同</strong>时，对多个事务的并发执行才是正确的。即一个给定的并发调度，当且仅当它是可串行化的，才是正确调度</p>
<p><strong>冲突操作</strong>：是指<strong>不同的事务</strong>对<strong>同一数据</strong>的<strong>读写</strong>操作和<strong>写写</strong>操作</p>
<p><strong>冲突可串行化调度</strong>是<strong>可串行化调度</strong>的<strong>充分</strong>条件，不是必要条件。即存在<strong>不满足</strong>冲突可串行化条件的可串行化调度</p>
<p><strong>不可交换</strong>：同一事务的两个操作 / 不同事务的冲突操作</p>
<p><strong>可交换</strong>：</p>
<ul>
<li>不同事务对同一数据的读读操作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>R</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R_i(x),R_j(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></li>
<li>不同事务对不同数据的各种操作</li>
</ul>
<h2 id="两段锁协议"><a class="markdownIt-Anchor" href="#两段锁协议">#</a> 两段锁协议</h2>
<p>指所有事务必须分两个阶段对数据项加锁和解锁</p>
<ul>
<li>
<p>扩展阶段：在对任何数据进行读、写操作之前，事务首先要获得对该数据的封锁</p>
</li>
<li>
<p>收缩阶段：在释放一个封锁之后，事务<strong>不再</strong>申请和获得任何其他封锁</p>
</li>
</ul>
<p>事务遵守两段锁协议是可串行化调度的充分条件，而不是必要条件。</p>
<p><strong>两段锁协议与防止死锁的一次封锁法</strong></p>
<ul>
<li>
<p>一次封锁法要求每个事务必须一次将所有要使用的数据全部加锁，因此遵守两段锁协议</p>
</li>
<li>
<p>两段锁协议并不要求事务必须一次将所有要使用的数据全部加锁，因此可能发生死锁</p>
</li>
</ul>
<h2 id="封锁的粒度"><a class="markdownIt-Anchor" href="#封锁的粒度">#</a> 封锁的粒度</h2>
<p>封锁粒度：封锁对象的大小</p>
<p>封锁的对象：逻辑单元，物理单元</p>
<p>例：在关系数据库中，封锁对象：</p>
<p><strong>逻辑单元</strong>：属性值、属性值的集合、元组、关系、索引项、整个索引、整个数据库等</p>
<p><strong>物理单元</strong>：页（数据页或索引页）、物理记录等</p>
<p>封锁粒度与系统的并发度和并发控制的开销密切相关。</p>
<ul>
<li>
<p>封锁的<strong>粒度越大</strong>，数据库所能够封锁的数据单元就越少并发度就越小，系统开销也越小</p>
</li>
<li>
<p>封锁的<strong>粒度越小</strong>，并发度较高，但系统开销也就越大</p>
</li>
</ul>
<h3 id="多粒度封锁"><a class="markdownIt-Anchor" href="#多粒度封锁">#</a> 多粒度封锁</h3>
<p>多粒度封锁：在一个系统中同时支持多种封锁粒度供不同的事务选择</p>
<p>多粒度树：根节点是整个数据库，表示最大的数据粒度，叶节点表示最小的数据粒度。</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411092014342.png" alt=""></p>
<p>允许多粒度树中的每个结点被独立地加锁</p>
<p>对一个结点加锁意味着这个结点的所有后裔结点也被加以同样类型的锁</p>
<p>一个数据对象可能以两种方式封锁：显式封锁和隐式封锁</p>
<p><strong>显式封锁</strong>：直接加到数据对象上的封锁</p>
<p><strong>隐式封锁</strong>：由于其上级结点加锁而使该数据对象加上了锁</p>
<h3 id="意向锁"><a class="markdownIt-Anchor" href="#意向锁">#</a> 意向锁</h3>
<p>引进意向锁，<strong>提高</strong>加锁时系统的<strong>检查效率</strong></p>
<p>如果对一个结点加意向锁，则说明<strong>下层结点正在被加锁</strong>；对任一结点加基本锁，<strong>必须先对它的上层结点加意向锁</strong></p>
<p>意向共享锁 **(IS 锁)**：事务 T1 要对<em> R</em>1 中某个元组加 S 锁，则要首先对关系<em> R</em>1 和数据库加 IS 锁</p>
<p>意向排它锁 **(IX 锁)**：事务 T1 要对 R1 中某个元组加 X 锁，则要首先对关系 R1 和数据库加 IX 锁</p>
<p>共享意向排它锁 **(SIX 锁)**：对某个表加 SIX 锁，则表示该事务要读整个表（所以要对该表加 S 锁），同时会更新个别元组（所以要对该表加 IX 锁）</p>
<p><strong>锁的强度</strong></p>
<p>锁的强度是指它对其他锁的排斥程度</p>
<p>申请封锁时以强锁代替弱锁是安全的，反之不然</p>
<p>具有意向锁的多粒度封锁方法</p>
<ul>
<li>
<p>申请封锁时应该按自上而下的次序进行（多粒度树）</p>
</li>
<li>
<p>释放封锁时则应该按自下而上的次序进行</p>
</li>
</ul>
<p>锁的强度：</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411092026909.png" alt=""></p>
<p>数据锁的相容矩阵：</p>
<p><img data-src="https://raw.githubusercontent.com/LUCKYCYYYY/WEb_img2/main/img/202411092027513.png" alt=""></p>

      <div class="tags">
          <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"><i class="ic i-tag"></i> 数据库</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2025-03-18 02:00:31" itemprop="dateModified" datetime="2025-03-18T02:00:31+08:00">2025-03-18</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="Aurijun 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="Aurijun 支付宝">
        <p>支付宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>Aurijun <i class="ic i-at"><em>@</em></i>眨眼的小星玥
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="http://www.luckycyyyy.top/2024/09/28/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/" title="数据库系统">http://www.luckycyyyy.top/2024/09/28/计算机科学/数据库/数据库系统/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/09/27/algorithm/%E7%AE%97%E6%B3%95OJ/Codeforce/Codeforces-970-Div3/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s21.ax1x.com&#x2F;2025&#x2F;03&#x2F;25&#x2F;pEDVQKg.png" title="Codeforces_970_Div3">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> Codeforces</span>
  <h3>Codeforces_970_Div3</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/10/02/algorithm/%E6%9D%82%E6%9D%82%E7%9A%84%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86/algorithm--%E7%BA%BF%E6%AE%B5%E6%A0%91/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s21.ax1x.com&#x2F;2025&#x2F;03&#x2F;22&#x2F;pE06ICn.png" title="线段树">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> 杂杂的算法知识</span>
  <h3>线段树</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%AA%E8%AE%BA"><span class="toc-number">1.</span> <span class="toc-text"> 绪论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text"> 数据库系统概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF%E7%9A%84%E4%BA%A7%E7%94%9F%E5%92%8C%E5%8F%91%E5%B1%95"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 数据管理技术的产生和发展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%89%B9%E7%82%B9"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 数据库系统特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text"> 数据模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E6%88%90%E8%A6%81%E7%B4%A0"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 组成要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 概念模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 逻辑模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 物理模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text"> 数据库系统结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%BA%A7%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 三级模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E6%98%A0%E5%B0%84%E5%8A%9F%E8%83%BD%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%8B%AC%E7%AB%8B%E6%80%A7"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 二级映射功能与数据独立性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.</span> <span class="toc-text"> 关系数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E5%BD%A2%E5%BC%8F%E5%8C%96%E5%AE%9A%E4%B9%89"><span class="toc-number">2.1.</span> <span class="toc-text"> 关系数据结构及形式化定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text"> 关系操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">2.3.</span> <span class="toc-text"> 关系的完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">2.3.1.</span> <span class="toc-text"> 实体完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">2.3.2.</span> <span class="toc-text"> 参照完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">2.3.3.</span> <span class="toc-text"> 用户定义的完整性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0"><span class="toc-number">2.4.</span> <span class="toc-text"> 关系代数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql"><span class="toc-number">3.</span> <span class="toc-text"> SQl</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E7%89%B9%E7%82%B9"><span class="toc-number">3.1.</span> <span class="toc-text"> SQL 特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89"><span class="toc-number">3.2.</span> <span class="toc-text"> 数据定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">3.2.1.1.</span> <span class="toc-text"> 定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">3.2.1.2.</span> <span class="toc-text"> 删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%A1%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 基本表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89-2"><span class="toc-number">3.2.2.1.</span> <span class="toc-text"> 定义</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%A8"><span class="toc-number">3.2.2.1.1.</span> <span class="toc-text"> 表：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%A8%E6%89%80%E5%B1%9E%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.2.2.1.2.</span> <span class="toc-text"> 表所属模式：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9"><span class="toc-number">3.2.2.2.</span> <span class="toc-text"> 修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4-2"><span class="toc-number">3.2.2.3.</span> <span class="toc-text"> 删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B"><span class="toc-number">3.2.3.1.</span> <span class="toc-text"> 建立</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-2"><span class="toc-number">3.2.3.2.</span> <span class="toc-text"> 修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4-3"><span class="toc-number">3.2.3.3.</span> <span class="toc-text"> 删除</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.</span> <span class="toc-text"> 数据查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 单表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E8%A1%A8%E4%B8%AD%E7%9A%84%E8%8B%A5%E5%B9%B2%E5%88%97"><span class="toc-number">3.3.1.1.</span> <span class="toc-text"> 选择表中的若干列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E8%A1%A8%E4%B8%AD%E8%8B%A5%E5%B9%B2%E5%85%83%E7%BB%84"><span class="toc-number">3.3.1.2.</span> <span class="toc-text"> 选择表中若干元组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#order-by"><span class="toc-number">3.3.1.3.</span> <span class="toc-text">  ORDER BY</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.1.4.</span> <span class="toc-text"> 聚集函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#group-by"><span class="toc-number">3.3.1.5.</span> <span class="toc-text">  GROUP BY</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E4%B8%8E%E9%9D%9E%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.2.1.</span> <span class="toc-text"> 等值与非等值连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BA%AB%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.2.2.</span> <span class="toc-text"> 自身连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.2.3.</span> <span class="toc-text"> 外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.2.4.</span> <span class="toc-text"> 多表连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.2.5.</span> <span class="toc-text"> 嵌套查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.3.</span> <span class="toc-text"> 集合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%B4%BE%E7%94%9F%E8%A1%A8%E7%9A%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.4.</span> <span class="toc-text"> 基于派生表的查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0"><span class="toc-number">3.4.</span> <span class="toc-text"> 数据更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">3.4.1.</span> <span class="toc-text"> 插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-number">3.4.2.</span> <span class="toc-text"> 修改数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">3.4.3.</span> <span class="toc-text"> 删除数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">3.5.</span> <span class="toc-text"> 视图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-number">4.</span> <span class="toc-text"> 数据库安全性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%89%B4%E5%88%AB"><span class="toc-number">4.1.</span> <span class="toc-text"> 身份鉴别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E4%B8%BB%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6dac"><span class="toc-number">4.2.</span> <span class="toc-text"> 自主存取控制 DAC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#grant"><span class="toc-number">4.2.1.</span> <span class="toc-text"> GRANT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#revoke"><span class="toc-number">4.2.2.</span> <span class="toc-text"> REVOKE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">4.2.3.</span> <span class="toc-text"> 创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%92%E8%89%B2"><span class="toc-number">4.2.4.</span> <span class="toc-text"> 角色</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6mac"><span class="toc-number">4.3.</span> <span class="toc-text"> 强制存取控制 MAC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E6%9C%BA%E5%88%B6"><span class="toc-number">4.4.</span> <span class="toc-text"> 视图机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1%E6%9C%BA%E5%88%B6"><span class="toc-number">4.5.</span> <span class="toc-text"> 审计机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%92%8C%E5%8F%96%E6%B6%88%E5%AE%A1%E8%AE%A1"><span class="toc-number">4.5.1.</span> <span class="toc-text"> 设置和取消审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86"><span class="toc-number">4.6.</span> <span class="toc-text"> 数据加密</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">5.</span> <span class="toc-text"> 数据库完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E5%AE%8C%E6%95%B4%E6%80%A7-2"><span class="toc-number">5.1.</span> <span class="toc-text"> 实体完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E5%AE%8C%E6%95%B4%E6%80%A7%E7%9A%84%E6%A3%80%E6%9F%A5"><span class="toc-number">5.1.1.</span> <span class="toc-text"> 实体完整性的检查</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7-2"><span class="toc-number">5.2.</span> <span class="toc-text"> 参照完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7%E7%9A%84%E6%A3%80%E6%9F%A5"><span class="toc-number">5.2.1.</span> <span class="toc-text"> 参照完整性的检查</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7-2"><span class="toc-number">5.3.</span> <span class="toc-text"> 用户定义的完整性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E5%91%BD%E5%90%8D"><span class="toc-number">5.4.</span> <span class="toc-text"> 完整性约束命名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%AD%E8%A8%80"><span class="toc-number">5.5.</span> <span class="toc-text"> 断言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">5.6.</span> <span class="toc-text"> 触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delimiter"><span class="toc-number">5.7.</span> <span class="toc-text"> delimiter</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%90%86%E8%AE%BA"><span class="toc-number">6.</span> <span class="toc-text"> 关系数据库理论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96"><span class="toc-number">6.1.</span> <span class="toc-text"> 函数依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%81"><span class="toc-number">6.1.1.</span> <span class="toc-text"> 码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%80%BC%E4%BE%9D%E8%B5%96"><span class="toc-number">6.2.</span> <span class="toc-text"> 多值依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8"><span class="toc-number">6.2.1.</span> <span class="toc-text"> 性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E5%92%8C%E5%A4%9A%E5%80%BC%E4%BE%9D%E8%B5%96%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">6.3.</span> <span class="toc-text"> 函数依赖和多值依赖的比较</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8C%83%E5%BC%8F"><span class="toc-number">6.4.</span> <span class="toc-text"> 范式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.</span> <span class="toc-text"> 数据库设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">7.1.</span> <span class="toc-text"> 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8"><span class="toc-number">7.1.1.</span> <span class="toc-text"> 数据字典</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.2.</span> <span class="toc-text"> 概念结构设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#e-r%E6%A8%A1%E5%9E%8B"><span class="toc-number">7.2.1.</span> <span class="toc-text"> E-R 模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.3.</span> <span class="toc-text"> 逻辑结构设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.4.</span> <span class="toc-text"> 物理结构设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E6%96%BD-%E8%BF%90%E8%A1%8C%E5%92%8C%E7%BB%B4%E6%8A%A4"><span class="toc-number">7.5.</span> <span class="toc-text"> 数据库实施、运行和维护</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B"><span class="toc-number">8.</span> <span class="toc-text"> 数据库编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8Fsql"><span class="toc-number">8.1.</span> <span class="toc-text"> 嵌入式 SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E4%B8%BB%E8%AF%AD%E8%A8%80%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="toc-number">8.1.1.</span> <span class="toc-text"> 与主语言之间的通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87%E7%9A%84sql%E8%AF%AD%E5%8F%A5"><span class="toc-number">8.1.2.</span> <span class="toc-text"> 不使用游标的 SQL 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87%E7%9A%84sql%E8%AF%AD%E5%8F%A5"><span class="toc-number">8.1.3.</span> <span class="toc-text"> 使用游标的 SQL 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81sql"><span class="toc-number">8.1.4.</span> <span class="toc-text"> 动态 SQL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B%E5%8C%96sql"><span class="toc-number">8.2.</span> <span class="toc-text"> 过程化 SQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F%E5%AE%9A%E4%B9%89"><span class="toc-number">8.3.</span> <span class="toc-text"> 变量和常量定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">8.3.1.</span> <span class="toc-text"> 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F"><span class="toc-number">8.3.2.</span> <span class="toc-text"> 常量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">8.4.</span> <span class="toc-text"> 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6"><span class="toc-number">8.4.1.</span> <span class="toc-text"> 条件控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6"><span class="toc-number">8.4.2.</span> <span class="toc-text"> 循环控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.5.</span> <span class="toc-text"> 存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">8.6.</span> <span class="toc-text"> 函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#odbc%E7%BC%96%E7%A8%8B"><span class="toc-number">8.7.</span> <span class="toc-text"> ODBC 编程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">9.</span> <span class="toc-text"> 关系查询优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E6%95%B0%E4%BC%98%E5%8C%96"><span class="toc-number">9.1.</span> <span class="toc-text"> 代数优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E4%BC%98%E5%8C%96"><span class="toc-number">9.2.</span> <span class="toc-text"> 物理优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D"><span class="toc-number">10.</span> <span class="toc-text"> 数据库恢复</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">10.1.</span> <span class="toc-text"> 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89-3"><span class="toc-number">10.1.1.</span> <span class="toc-text"> 定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#acid%E7%89%B9%E6%80%A7"><span class="toc-number">10.1.2.</span> <span class="toc-text"> ACID 特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%85%E9%9A%9C"><span class="toc-number">10.2.</span> <span class="toc-text"> 故障</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%86%85%E9%83%A8%E7%9A%84%E6%95%85%E9%9A%9C"><span class="toc-number">10.2.1.</span> <span class="toc-text"> 事务内部的故障</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C"><span class="toc-number">10.2.2.</span> <span class="toc-text"> 系统故障</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E8%B4%A8%E6%95%85%E9%9A%9C"><span class="toc-number">10.2.3.</span> <span class="toc-text"> 介质故障</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%97%85%E6%AF%92"><span class="toc-number">10.2.4.</span> <span class="toc-text"> 计算机病毒</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E5%AE%9E%E7%8E%B0%E6%8A%80%E6%9C%AF"><span class="toc-number">10.3.</span> <span class="toc-text"> 恢复实现技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BD%AC%E5%82%A8"><span class="toc-number">10.3.1.</span> <span class="toc-text"> 数据转储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">10.3.2.</span> <span class="toc-text"> 日志文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5"><span class="toc-number">10.4.</span> <span class="toc-text"> 恢复策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E6%95%85%E9%9A%9C%E7%9A%84%E6%81%A2%E5%A4%8D"><span class="toc-number">10.4.1.</span> <span class="toc-text"> 事务故障的恢复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E7%9A%84%E6%81%A2%E5%A4%8D"><span class="toc-number">10.4.2.</span> <span class="toc-text"> 系统故障的恢复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E8%B4%A8%E6%95%85%E9%9A%9C%E7%9A%84%E6%81%A2%E5%A4%8D"><span class="toc-number">10.4.3.</span> <span class="toc-text"> 介质故障的恢复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E6%9C%89%E6%A3%80%E6%9F%A5%E7%82%B9%E7%9A%84%E6%81%A2%E5%A4%8D"><span class="toc-number">10.4.4.</span> <span class="toc-text"> 具有检查点的恢复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F"><span class="toc-number">10.5.</span> <span class="toc-text"> 镜像</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6"><span class="toc-number">11.</span> <span class="toc-text"> 并发控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E6%A6%82%E8%BF%B0"><span class="toc-number">11.1.</span> <span class="toc-text"> 并发控制概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%81%E9%94%81"><span class="toc-number">11.2.</span> <span class="toc-text"> 封锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">11.2.1.</span> <span class="toc-text"> 封锁协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B4%BB%E9%94%81%E5%92%8C%E6%AD%BB%E9%94%81"><span class="toc-number">11.3.</span> <span class="toc-text"> 活锁和死锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%8A%E6%96%AD%E5%B9%B6%E8%A7%A3%E9%99%A4%E6%AD%BB%E9%94%81"><span class="toc-number">11.3.1.</span> <span class="toc-text"> 诊断并解除死锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E8%B0%83%E5%BA%A6%E7%9A%84%E5%8F%AF%E4%B8%B2%E8%A1%8C%E6%80%A7"><span class="toc-number">11.4.</span> <span class="toc-text"> 并发调度的可串行性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E6%AE%B5%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">11.5.</span> <span class="toc-text"> 两段锁协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%81%E9%94%81%E7%9A%84%E7%B2%92%E5%BA%A6"><span class="toc-number">11.6.</span> <span class="toc-text"> 封锁的粒度</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E7%B2%92%E5%BA%A6%E5%B0%81%E9%94%81"><span class="toc-number">11.6.1.</span> <span class="toc-text"> 多粒度封锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%90%91%E9%94%81"><span class="toc-number">11.6.2.</span> <span class="toc-text"> 意向锁</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li class="active"><a href="/2024/09/28/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/" rel="bookmark" title="数据库系统">数据库系统</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="Aurijun"
      data-src="/images/cyy.png">
  <p class="name" itemprop="name">Aurijun</p>
  <div class="description" itemprop="description">小星玥，要努力学习呀！</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">103</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">32</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">56</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0xVQ0tZQ1lZWVk=" title="https:&#x2F;&#x2F;github.com&#x2F;LUCKYCYYYY"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>网站</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/09/27/algorithm/%E7%AE%97%E6%B3%95OJ/Codeforce/Codeforces-970-Div3/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/10/02/algorithm/%E6%9D%82%E6%9D%82%E7%9A%84%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86/algorithm--%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2023 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Aurijun @ Aurijun</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="站点总字数">601k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="站点阅读时长">9:07</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/09/28/计算机科学/数据库/数据库系统/',
    favicon: {
      show: "嘿嘿好久不见(*¯︶¯*)",
      hide: "哎呀~走掉惹"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,copy_tex: true,
    katex: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
